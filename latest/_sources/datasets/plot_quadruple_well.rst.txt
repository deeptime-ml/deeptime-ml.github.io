
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "datasets/plot_quadruple_well.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_datasets_plot_quadruple_well.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_datasets_plot_quadruple_well.py:


Quadruple-well
==============

Example for the :meth:`deeptime.data.quadruple_well` dataset.

.. GENERATED FROM PYTHON SOURCE LINES 7-40



.. image-sg:: /datasets/images/sphx_glr_plot_quadruple_well_001.png
   :alt: Example of a trajectory in the potential landscape
   :srcset: /datasets/images/sphx_glr_plot_quadruple_well_001.png
   :class: sphx-glr-single-img





.. code-block:: default
   :lineno-start: 8


    import numpy as np
    import scipy
    import matplotlib.pyplot as plt
    from matplotlib.collections import LineCollection

    from deeptime.data import quadruple_well

    system = quadruple_well(n_steps=1000)
    traj = system.trajectory(np.array([[1, -1]]), 100, seed=46)

    xy = np.arange(-2, 2, 0.1)
    coords = np.dstack(np.meshgrid(xy, xy)).reshape(-1, 2)
    V = system.potential(coords).reshape((xy.shape[0], xy.shape[0]))

    fig, ax = plt.subplots(1, 1)
    ax.set_title("Example of a trajectory in the potential landscape")

    cb = ax.contourf(xy, xy, V, levels=np.linspace(0.0, 3.0, 20), cmap='coolwarm')

    x = np.r_[traj[:, 0]]
    y = np.r_[traj[:, 1]]
    f, u = scipy.interpolate.splprep([x, y], s=0, per=False)
    xint, yint = scipy.interpolate.splev(np.linspace(0, 1, 50000), f)

    points = np.stack([xint, yint]).T.reshape(-1, 1, 2)
    segments = np.concatenate([points[:-1], points[1:]], axis=1)
    coll = LineCollection(segments, cmap='bwr')
    coll.set_array(np.linspace(0, 1, num=len(points), endpoint=True))
    coll.set_linewidth(1)
    ax.add_collection(coll)

    fig.colorbar(cb)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.688 seconds)

**Estimated memory usage:**  28 MB


.. _sphx_glr_download_datasets_plot_quadruple_well.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_quadruple_well.py <plot_quadruple_well.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_quadruple_well.ipynb <plot_quadruple_well.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
