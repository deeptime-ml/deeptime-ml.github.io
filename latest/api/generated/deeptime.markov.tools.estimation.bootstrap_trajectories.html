
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>deeptime.markov.tools.estimation.bootstrap_trajectories &#8212; deeptime 0.4.3+14.geb0668c2.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/d3.v5.min.js"></script>
    <script src="../../_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="../../_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="deeptime.markov.tools.estimation.prior_neighbor" href="deeptime.markov.tools.estimation.prior_neighbor.html" />
    <link rel="prev" title="deeptime.markov.tools.estimation.bootstrap_counts" href="deeptime.markov.tools.estimation.bootstrap_counts.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon-16x16.png">
<link rel="manifest" href="../../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov.html">deeptime.markov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index_markov_tools.html">deeptime.markov.tools</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index_markov_tools.html#msm-estimation">MSM estimation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index_markov_tools.html#countmatrix">Countmatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index_markov_tools.html#connectivity">Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index_markov_tools.html#estimation">Estimation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index_markov_tools.html#sampling">Sampling</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index_markov_tools.html#bootstrap">Bootstrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index_markov_tools.html#priors">Priors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov_tools.html#msm-analysis">MSM analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov_tools.html#transition-path-theory-tools">Transition path theory tools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_plots.html">deeptime.plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../../index.html">Latest release
            (0.4.3)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index_markov_tools.html">deeptime.markov.tools</a><ul>
      <li>Previous: <a href="deeptime.markov.tools.estimation.bootstrap_counts.html" title="previous chapter">deeptime.markov.tools.estimation.bootstrap_counts</a></li>
      <li>Next: <a href="deeptime.markov.tools.estimation.prior_neighbor.html" title="next chapter">deeptime.markov.tools.estimation.prior_neighbor</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="deeptime-markov-tools-estimation-bootstrap-trajectories">
<h1>deeptime.markov.tools.estimation.bootstrap_trajectories<a class="headerlink" href="#deeptime-markov-tools-estimation-bootstrap-trajectories" title="Permalink to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="deeptime.markov.tools.estimation.bootstrap_trajectories">
<span class="sig-prename descclassname"><span class="pre">deeptime.markov.tools.estimation.</span></span><span class="sig-name descname"><span class="pre">bootstrap_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correlation_length</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.tools.estimation.bootstrap_trajectories" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a randomly resampled trajectory segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajs</strong> (<em>array-like</em><em> or </em><em>array-like of array-like</em>) – single or multiple trajectories. Every trajectory is assumed to be
a statistically independent realization. Note that this is often not true and
is a weakness with the present bootstrapping approach.</p></li>
<li><p><strong>correlation_length</strong> (<em>int</em>) – Correlation length (also known as the or statistical inefficiency) of the data.
If set to &lt; 1 or &gt; L, where L is the longest trajectory length, the
bootstrapping will sample full trajectories.
We suggest to select the largest implied timescale or relaxation timescale as a
conservative estimate of the correlation length. If this timescale is unknown,
it’s suggested to use full trajectories (set timescale to &lt; 1) or come up with
a rough estimate. For computing the error on specific observables, one may use
shorter timescales, because the relevant correlation length is the integral of
the autocorrelation function of the observables of interest <a class="footnote-reference brackets" href="#id7" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. The slowest
implied timescale is an upper bound for that correlation length, and therefore
a conservative estimate <a class="footnote-reference brackets" href="#id8" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function can be called multiple times in order to generate randomly
resampled trajectory data. In order to compute error bars on your observable
of interest, call this function to generate resampled trajectories, and
put them into your estimator. The standard deviation of such a sample of
the observable is a model for the standard error.</p>
<p>Implements a moving block bootstrapping procedure <a class="footnote-reference brackets" href="#id5" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> for generation of
randomly resampled count matrixes from discrete trajectories. The corrlation length
determines the size of trajectory blocks that will remain contiguous.
For a single trajectory N with correlation length t_corr &lt; N,
we will sample floor(N/t_corr) subtrajectories of length t_corr using starting time t.
t is a uniform random number in [0, N-t_corr-1].
When multiple trajectories are available, N is the total number of timesteps
over all trajectories, the algorithm will generate resampled data with a total number
of N (or slightly larger) time steps. Each trajectory of length n_i has a probability
of n_i to be selected. Trajectories of length n_i &lt;= t_corr are returned completely.
For longer trajectories, segments of length t_corr are randomly generated.</p>
<p>Note that like all error models for correlated time series data, Bootstrapping
just gives you a model for the error given a number of assumptions <a class="footnote-reference brackets" href="#id6" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. The most
critical decisions are: (1) is this approach meaningful at all (only if the
trajectories are statistically independent realizations), and (2) select
an appropriate timescale of the correlation length (see below).
Note that transition matrix sampling from the Dirichlet distribution is a
much better option from a theoretical point of view, but may also be
computationally more demanding.</p>
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id5" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>H. R. Kuensch. The jackknife and the bootstrap for general
stationary observations, Ann. Stat. 3, 1217-41 (1989).</p>
</aside>
<aside class="footnote brackets" id="id6" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">2</a><span class="fn-bracket">]</span></span>
<p>B. Efron. Bootstrap methods: Another look at the jackknife.
Ann. Statist. 7 1-26 (1979).</p>
</aside>
<aside class="footnote brackets" id="id7" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">3</a><span class="fn-bracket">]</span></span>
<p>T.W. Anderson. The Statistical Analysis of Time Series
Wiley, New York (1971).</p>
</aside>
<aside class="footnote brackets" id="id8" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">4</a><span class="fn-bracket">]</span></span>
<p>F. Noe and F. Nueske: A variational approach to modeling
slow processes in stochastic dynamical systems.  SIAM
Multiscale Model. Simul., 11 . pp. 635-655 (2013)</p>
</aside>
</aside>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../../_static/scrollbar.js"></script>

  </body>
</html>