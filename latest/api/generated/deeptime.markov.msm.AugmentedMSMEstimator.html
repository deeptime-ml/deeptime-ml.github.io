<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>class AugmentedMSMEstimator &#8212; deeptime 0.4.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=822347c1" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=1e544560" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=8ffeb421" />
    <link rel="stylesheet" type="text/css" href="../../_static/perfect-scrollbar/css/perfect-scrollbar.css?v=9f1a41f4" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css?v=91adb8b6" />
    <script src="../../_static/documentation_options.js?v=340bb9e5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js?v=a8314474"></script>
    <script src="../../_static/d3.v5.min.js?v=5b739c40"></script>
    <script src="../../_static/d3-legend.min.js?v=5895a191"></script>
    <script src="../../_static/katex.min.js?v=be8ff15f"></script>
    <script src="../../_static/auto-render.min.js?v=ad136472"></script>
    <script src="../../_static/katex_autorenderer.js?v=bebc588a"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="class AugmentedMSM" href="deeptime.markov.msm.AugmentedMSM.html" />
    <link rel="prev" title="class KoopmanReweightedMSM" href="deeptime.markov.msm.KoopmanReweightedMSM.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon-16x16.png">
<link rel="manifest" href="../../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_nbexamples.html">Notebook examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index_markov.html">deeptime.markov</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#estimators">Estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#analysis-tools">Analysis tools</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index_markov.html#utilities-and-alternatives">Utilities and alternatives</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.number_of_states.html"><em>function</em> number_of_states</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.count_states.html"><em>function</em> count_states</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.compute_connected_sets.html"><em>function</em> compute_connected_sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.compute_dtrajs_effective.html"><em>function</em> compute_dtrajs_effective</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.compute_effective_stride.html"><em>function</em> compute_effective_stride</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.sample.indices_by_distribution.html"><em>function</em> indices_by_distribution</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.sample.compute_index_states.html"><em>function</em> compute_index_states</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.sample.indices_by_sequence.html"><em>function</em> indices_by_sequence</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.sample.indices_by_state.html"><em>function</em> indices_by_state</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.msm.TRAMDataset.html"><em>class</em> TRAMDataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index_markov.html#transition-counting">Transition counting</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index_markov.html#special-msm-estimators-and-models">Special MSM estimators and models</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_plots.html">deeptime.plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../../index.html">Latest release
            (0.4.5)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index_markov.html">deeptime.markov</a><ul>
      <li>Previous: <a href="deeptime.markov.msm.KoopmanReweightedMSM.html" title="previous chapter"><em>class</em> KoopmanReweightedMSM</a></li>
      <li>Next: <a href="deeptime.markov.msm.AugmentedMSM.html" title="next chapter"><em>class</em> AugmentedMSM</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="class-augmentedmsmestimator">
<h1><em>class</em> AugmentedMSMEstimator<a class="headerlink" href="#class-augmentedmsmestimator" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeptime.markov.msm.</span></span><span class="sig-name descname"><span class="pre">AugmentedMSMEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expectations_by_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experimental_measurements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experimental_measurement_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator" title="Link to this definition">¶</a></dt>
<dd><p>Estimator for augmented Markov state models. <a class="footnote-reference brackets" href="#footcite-olsson2017combining" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>
This estimator is based on expectation values from experiments.
In case the experimental data is a time series matching a discrete time series, a convenience function
<a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories" title="deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories"><code class="xref py py-meth docutils literal notranslate"><span class="pre">estimator_from_feature_trajectories()</span></code></a> is offered.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expectations_by_state</strong> (<em>(</em><em>n</em><em>, </em><em>k</em><em>) </em><em>ndarray</em>) – Expectations by state. n Markov states, k experimental observables; each index is
average over members of the Markov state.</p></li>
<li><p><strong>experimental_measurements</strong> (<em>(</em><em>k</em><em>,</em><em>) </em><em>ndarray</em>) – The experimental measurements.</p></li>
<li><p><strong>experimental_measurement_weights</strong> (<em>(</em><em>k</em><em>,</em><em>) </em><em>ndarray</em>) – Experimental measurements weights.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.05</em>) – <p>Additional convergence criterion used when some experimental data
are outside the support of the simulation. The value of the eps
parameter is the threshold of the relative change in the predicted
observables as a function of fixed-point iteration:</p>
<div class="math">
\[\mathrm{eps} > \frac{\mid o_{\mathrm{pred}}^{(i+1)}-o_{\mathrm{pred}}^{(i)}\mid }{\sigma}.

\]</div>
</p></li>
<li><p><strong>support_ci</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1.0</em>) – Confidence interval for determination whether experimental data are inside or outside Markov model support.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=500</em>) – Optional parameter with specifies the maximum number of updates for Lagrange multiplier estimation.</p></li>
<li><p><strong>max_cache</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=3000</em>) – Maximum size (in megabytes) of cache when computing R tensor.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<div class="docutils container" id="id2">
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-olsson2017combining" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Simon Olsson, Hao Wu, Fabian Paul, Cecilia Clementi, and Frank Noé. Combining experimental and simulation data of molecular processes via augmented markov models. <em>Proceedings of the National Academy of Sciences</em>, 114(31):8265–8270, 2017.</p>
</aside>
</aside>
</div>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.convergence_criterion_lagrange" title="deeptime.markov.msm.AugmentedMSMEstimator.convergence_criterion_lagrange"><code class="xref py py-obj docutils literal notranslate"><span class="pre">convergence_criterion_lagrange</span></code></a></p></td>
<td><p>Additional convergence criterion used when some experimental data are outside the support of the simulation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.expectations_by_state" title="deeptime.markov.msm.AugmentedMSMEstimator.expectations_by_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expectations_by_state</span></code></a></p></td>
<td><p>The expectations by state (N) for each observable (K).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurement_weights" title="deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurement_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">experimental_measurement_weights</span></code></a></p></td>
<td><p>Weights for experimental measurement averages (K).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurements" title="deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurements"><code class="xref py py-obj docutils literal notranslate"><span class="pre">experimental_measurements</span></code></a></p></td>
<td><p>Experimental measurement averages (K).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.has_model" title="deeptime.markov.msm.AugmentedMSMEstimator.has_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_model</span></code></a></p></td>
<td><p>Property reporting whether this estimator contains an estimated model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.max_cache" title="deeptime.markov.msm.AugmentedMSMEstimator.max_cache"><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_cache</span></code></a></p></td>
<td><p>Cache size during computation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.maxiter" title="deeptime.markov.msm.AugmentedMSMEstimator.maxiter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">maxiter</span></code></a></p></td>
<td><p>Maximum number of Newton iterations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.model" title="deeptime.markov.msm.AugmentedMSMEstimator.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></p></td>
<td><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fetch_model" title="deeptime.markov.msm.AugmentedMSMEstimator.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.reversible" title="deeptime.markov.msm.AugmentedMSMEstimator.reversible"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reversible</span></code></a></p></td>
<td><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.sparse" title="deeptime.markov.msm.AugmentedMSMEstimator.sparse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse</span></code></a></p></td>
<td><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.support_confidence" title="deeptime.markov.msm.AugmentedMSMEstimator.support_confidence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">support_confidence</span></code></a></p></td>
<td><p>Confidence interval size for markov states.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.uncertainties" title="deeptime.markov.msm.AugmentedMSMEstimator.uncertainties"><code class="xref py py-obj docutils literal notranslate"><span class="pre">uncertainties</span></code></a></p></td>
<td><p>Uncertainties based on measurement weights.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories" title="deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimator_from_feature_trajectories</span></code></a>(...[, ...])</p></td>
<td><p>Creates an AMM estimator from discrete trajectories and corresponding experimental data.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fetch_model" title="deeptime.markov.msm.AugmentedMSMEstimator.fetch_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_model</span></code></a>()</p></td>
<td><p>Yields the most recently estimated AMM or None if <a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit" title="deeptime.markov.msm.AugmentedMSMEstimator.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> was not called yet.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit" title="deeptime.markov.msm.AugmentedMSMEstimator.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(data, *args, **kw)</p></td>
<td><p>Fits an AMM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit_fetch" title="deeptime.markov.msm.AugmentedMSMEstimator.fit_fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_fetch</span></code></a>(data, **kwargs)</p></td>
<td><p>Fits the internal model on data and subsequently fetches it in one call.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.get_params" title="deeptime.markov.msm.AugmentedMSMEstimator.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Get the parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.set_params" title="deeptime.markov.msm.AugmentedMSMEstimator.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">estimator_from_feature_trajectories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">discrete_trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experimental_measurements</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmas</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">support_ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_cache</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.estimator_from_feature_trajectories" title="Link to this definition">¶</a></dt>
<dd><p>Creates an AMM estimator from discrete trajectories and corresponding experimental data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>discrete_trajectories</strong> (<em>array_like</em><em> or </em><em>list</em><em> of </em><em>array_like</em>) – Discrete trajectories, stored as integer ndarrays (arbitrary size) or a single ndarray for
only one trajectory.</p></li>
<li><p><strong>feature_trajectories</strong> (<em>array_like</em><em> or </em><em>list</em><em> of </em><em>array_like</em>) – The same shape (number of trajectories and timesteps) as dtrajs. Each timestep in each trajectory should
match the shape of the measurements and sigmas, K.</p></li>
<li><p><strong>n_states</strong> (<em>int</em>) – Number of markov states in full state space.</p></li>
<li><p><strong>experimental_measurements</strong> (<em>(</em><em>K</em><em>,</em><em>) </em><em>ndarray</em>) – Experimental averages.</p></li>
<li><p><strong>sigmas</strong> (<em>(</em><em>K</em><em>,</em><em>) </em><em>ndarray</em>) – Standard error for each experimental observable.</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>default = 0.05</em>) – Convergence criterium, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>.</p></li>
<li><p><strong>support_ci</strong> (<em>float</em><em>, </em><em>default=1.0</em>) – Confidence interval, see <code class="xref py py-meth docutils literal notranslate"><span class="pre">__init__()</span></code>.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=500</em>) – Maximum number of iterations.</p></li>
<li><p><strong>max_cache</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=3000</em>) – Parameter which specifies the maximum size of cache used
when performing estimation of AMM, in megabytes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>estimator</strong> – An estimator parameterized expectations by state based on feature trajectories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator" title="deeptime.markov.msm.AugmentedMSMEstimator">AugmentedMSMEstimator</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.fetch_model">
<span class="sig-name descname"><span class="pre">fetch_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="deeptime.markov.msm.AugmentedMSM.html#deeptime.markov.msm.AugmentedMSM" title="deeptime.markov.msm._augmented_msm.AugmentedMSM"><span class="pre">AugmentedMSM</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.fetch_model" title="Link to this definition">¶</a></dt>
<dd><p>Yields the most recently estimated AMM or None if <a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit" title="deeptime.markov.msm.AugmentedMSMEstimator.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> was not called yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>amm</strong> – The AMM instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="deeptime.markov.msm.AugmentedMSM.html#deeptime.markov.msm.AugmentedMSM" title="deeptime.markov.msm.AugmentedMSM">AugmentedMSM</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit" title="Link to this definition">¶</a></dt>
<dd><p>Fits an AMM.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference internal" href="deeptime.markov.TransitionCountModel.html#deeptime.markov.TransitionCountModel" title="deeptime.markov.TransitionCountModel"><em>TransitionCountModel</em></a><em> or </em><em>(</em><em>N</em><em>, </em><em>N</em><em>) </em><em>ndarray</em>) – Count matrix over data.</p></li>
<li><p><strong>*args</strong> – scikit-learn compatibility argument</p></li>
<li><p><strong>**kw</strong> – scikit-learn compatibility argument</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Reference to self.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator" title="deeptime.markov.msm.AugmentedMSMEstimator">AugmentedMSMEstimator</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.fit_fetch">
<span class="sig-name descname"><span class="pre">fit_fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit_fetch" title="Link to this definition">¶</a></dt>
<dd><p>Fits the internal model on data and subsequently fetches it in one call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em>) – Data that is used to fit the model.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments to <a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fit" title="deeptime.markov.msm.AugmentedMSMEstimator.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The estimated model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.get_params" title="Link to this definition">¶</a></dt>
<dd><p>Get the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>mapping of string to any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.set_params" title="Link to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>**params</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.convergence_criterion_lagrange">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convergence_criterion_lagrange</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.convergence_criterion_lagrange" title="Link to this definition">¶</a></dt>
<dd><p>Additional convergence criterion used when some experimental data
are outside the support of the simulation. The value of the eps
parameter is the threshold of the relative change in the predicted
observables as a function of fixed-point iteration:</p>
<p>$$ mathrm{eps} &gt; frac{mid o_{mathrm{pred}}^{(i+1)}-o_{mathrm{pred}}^{(i)}mid }{sigma}. $$</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.expectations_by_state">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">expectations_by_state</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.expectations_by_state" title="Link to this definition">¶</a></dt>
<dd><p>The expectations by state (N) for each observable (K).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(N, K) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurement_weights">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">experimental_measurement_weights</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurement_weights" title="Link to this definition">¶</a></dt>
<dd><p>Weights for experimental measurement averages (K).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(K,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurements">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">experimental_measurements</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.experimental_measurements" title="Link to this definition">¶</a></dt>
<dd><p>Experimental measurement averages (K).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(K,) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.has_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.has_model" title="Link to this definition">¶</a></dt>
<dd><p>Property reporting whether this estimator contains an estimated model. This assumes that the model
is initialized with <cite>None</cite> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.max_cache">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_cache</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.max_cache" title="Link to this definition">¶</a></dt>
<dd><p>Cache size during computation.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.maxiter">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">maxiter</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.maxiter" title="Link to this definition">¶</a></dt>
<dd><p>Maximum number of Newton iterations.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.model" title="Link to this definition">¶</a></dt>
<dd><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.AugmentedMSMEstimator.fetch_model" title="deeptime.markov.msm.AugmentedMSMEstimator.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.reversible">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reversible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.reversible" title="Link to this definition">¶</a></dt>
<dd><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.sparse">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.sparse" title="Link to this definition">¶</a></dt>
<dd><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.
In this case python sparse matrices will be returned by the corresponding functions instead of numpy arrays.
This behavior is suggested for very large numbers of states (e.g. &gt; 4000) because it is likely
to be much more efficient.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.support_confidence">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">support_confidence</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.support_confidence" title="Link to this definition">¶</a></dt>
<dd><p>Confidence interval size for markov states.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.AugmentedMSMEstimator.uncertainties">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">uncertainties</span></span><a class="headerlink" href="#deeptime.markov.msm.AugmentedMSMEstimator.uncertainties" title="Link to this definition">¶</a></dt>
<dd><p>Uncertainties based on measurement weights.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../../_static/scrollbar.js"></script>

  </body>
</html>