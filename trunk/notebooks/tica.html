
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>TICA &#8212; deeptime 0.3.1+10.g65eecc5c.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../_static/d3.v5.min.js"></script>
    <script src="../_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="../_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="VAMP / time-lagged CCA" href="vamp.html" />
    <link rel="prev" title="Dimension reduction" href="../index_dimreduction.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../_static/favicon-16x16.png">
<link rel="manifest" href="../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index_dimreduction.html">Dimension reduction</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">TICA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Comparison-vs. PCA">Comparison vs. PCA</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Eigenvector-scaling">Eigenvector scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Koopman-reweighting">Koopman reweighting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="vamp.html">VAMP / time-lagged CCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="kcca.html">Kernel VAMP / kernel CCA</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmd.html">DMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="edmd.html">EDMD</a></li>
<li class="toctree-l2"><a class="reference internal" href="kedmd.html">Kernel EDMD</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_markov.html">deeptime.markov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../index.html">Latest release
            (0.3.1)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../contents.html">Documentation overview</a><ul>
  <li><a href="../index_dimreduction.html">Dimension reduction</a><ul>
      <li>Previous: <a href="../index_dimreduction.html" title="previous chapter">Dimension reduction</a></li>
      <li>Next: <a href="vamp.html" title="next chapter">VAMP / time-lagged CCA</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="TICA">
<h1>TICA<a class="headerlink" href="#TICA" title="Permalink to this headline">¶</a></h1>
<p>For users already familiar with the TICA interface: The corresponding <a class="reference internal" href="../api/generated/deeptime.decomposition.TICA.html#deeptime.decomposition.TICA"><span class="std std-ref">API docs</span></a>.</p>
<p>TICA <a class="footnote-reference brackets" href="#footcite-molgedey1994separation" id="id1">1</a> is short for Time-lagged Independent Component Analysis (sometimes also time structure-based ICA) and is a linear transformation method that can be used for dimensionality reduction. It was introduced for molecular dynamics in <a class="footnote-reference brackets" href="#footcite-naritomi2011slow" id="id2">2</a>, later <a class="footnote-reference brackets" href="#footcite-perez2013identification" id="id3">3</a> and as a method in the pipeline of Markov model construction in <a class="footnote-reference brackets" href="#footcite-perez2013identification" id="id4">3</a> and <a class="footnote-reference brackets" href="#footcite-schwantes2013improvements" id="id5">4</a>.</p>
<p>TICA with featurized data is algorithmically identical to extended dynamic mode decomposition (EDMD) <a class="footnote-reference brackets" href="#footcite-williams2015data" id="id6">5</a> (otherwise dynamic mode decomposition (DMD) <a class="footnote-reference brackets" href="#footcite-schmid2010dynamic" id="id7">6</a>), which is in pracitice also used to analyze time series which are not in detailed balance, yielding complex-valued eigenfunctions.</p>
<blockquote>
<div><p>The input for the TICA algorithm is a time-series dataset. Due to the linear nature of the method it can help, to first featurize the input data by passing it through nonlinear functions. This could be for example pairwise distances in case the input is based on molecular dynamics data.</p>
</div></blockquote>
<p>When the input data is the result of a Markov process, TICA finds in fact an approximation to the eigenfunctions and eigenvalues of the underlying Markov operator <a class="footnote-reference brackets" href="#footcite-perez2013identification" id="id8">3</a>.</p>
<p>To that end, it maps the data to the “slow” processes, i.e., it finds the coordinates of maximal autocorrelation at a given lag time <span class="math">\(\tau\)</span>.</p>
<p>Given a sequence of multivariate data <span class="math">\(X_t\)</span>, it computes the mean-free covariance and time-lagged covariance matrix</p>
<div class="math">
\[\begin{aligned}
C_0 &=      (X_t - \mu)^T \mathrm{diag}(w) (X_t - \mu), \\
C_{\tau} &= (X_t - \mu)^T \mathrm{diag}(w) (X_{t + \tau} - \mu),
\end{aligned}\]</div>
<p>where <span class="math">\(w\)</span> is a vector of weights for each time step. Optionally, one can use the reversible estimate by using symmetrized correlation matrices</p>
<div class="math">
\[\sum_t X_t + X_{t+\tau}

\]</div>
<p>and second moment matrices defined by</p>
<div class="math">
\[X_t^\top X_t + X_{t+\tau}^\top X_{t+\tau} \;\text{ and }\; X_{t+\tau}^\top X_t + X_t^\top X_{t+\tau}.

\]</div>
<p>By default, the weights <span class="math">\(w\)</span> are all equal to one, but different weights are possible, like the re-weighting to equilibrium described in <a class="footnote-reference brackets" href="#footcite-wu2017variational" id="id9">7</a>. Subsequently, the eigenvalue problem</p>
<div class="math">
\[C_{\tau} r_i = C_0 \lambda_i r_i

\]</div>
<p>is solved,where <span class="math">\(r_i\)</span> are the independent components and <span class="math">\(\lambda_i\)</span> are their respective normalized time-autocorrelations. The eigenvalues are related to the relaxation timescale by</p>
<div class="math">
\[t_i = -\frac{\tau}{\ln |\lambda_i|}.

\]</div>
<p>When used as a dimension reduction method, the input data is projected onto the dominant independent components. Since the eigenvalues <span class="math">\(\lambda_i\)</span> are indicators of the slowness of their respective processes, these dominant components belong to the slowest processes in the data.</p>
<p>When the underlying operator is defined on a compact domain (e.g., in Euclidean spaces this is equivalent to a closed and bounded subset like closed intervals), the spectrum of the operator is discrete <a class="footnote-reference brackets" href="#footcite-landau2013quantum" id="id10">8</a>. In that case one can ask whether there is a “spectral gap” (with which we mean a gap within the ordered sequence of eigenvalues which is significant). Eigenvalues which are larger than said gap would belong to “slow” (per association to timescales) processes in the
system, eigenvalues lower than the gap belong to fast processes.</p>
<p>Said spectral gap can help with the decision of the number of dimensions to project onto.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># NumPy for general numerical operations</span>
</pre></div>
</div>
</div>
<p>Given a time series, default TICA can be applied by calling</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">deeptime.decomposition</span> <span class="kn">import</span> <span class="n">TICA</span>

<span class="n">tica</span> <span class="o">=</span> <span class="n">TICA</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>yielding an estimator which operates on symmetrized correlation matrices and takes as many eigenvalues as required to capture 95% of the kinetic variance of the time series.</p>
<p>It can be fit by calling <a class="reference internal" href="../api/generated/deeptime.decomposition.TICA.html#deeptime.decomposition.TICA.fit"><span class="std std-ref">fit()</span></a>. This method distinguishes between arguments which are covariance matrices in form of a symmetrized <a class="reference internal" href="../api/generated/deeptime.covariance.CovarianceModel.html#deeptime.covariance.CovarianceModel"><span class="std std-ref">CovarianceModel</span></a> and raw timeseries data. In case of raw timeseries data, the lagtime <span class="math">\(\tau\)</span> must be provided, otherwise it is inferred from the covariance model.</p>
<p><em>Note</em>: TICA makes reversible estimates and then assumes, that the data is in equilibrium. In case of reversible estimate but non-equilibrium data (e.g., many short trajectories which start off-equilibrium), <a class="reference external" href="#Koopman-reweighting">Koopman reweighting</a> can be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TICA-140336049935648:dim=None, epsilon=1e-06, lagtime=1,
           scaling=&#39;kinetic_map&#39;, var_cutoff=None]
</pre></div></div>
</div>
<p>Optionally, covariances can be estimated and then used to fit the estimator. The <a class="reference internal" href="../api/generated/deeptime.decomposition.TICA.html#deeptime.decomposition.TICA.covariance_estimator"><span class="std std-ref">covariance_estimator</span></a> method yields a <a class="reference internal" href="../api/generated/deeptime.covariance.Covariance.html#deeptime.covariance.Covariance"><span class="std std-ref">Covariance</span></a> estimator which is properly configured for TICA (i.e., it symmetrizes the covariances and computes <span class="math">\(C_{00} = C_{tt}\)</span> and <span class="math">\(C_{0t}\)</span>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">covariances</span> <span class="o">=</span> <span class="n">TICA</span><span class="o">.</span><span class="n">covariance_estimator</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">covariances</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TICA-140336049935648:dim=None, epsilon=1e-06, lagtime=1,
           scaling=&#39;kinetic_map&#39;, var_cutoff=None]
</pre></div></div>
</div>
<p>The model can be obtained by a call to <a class="reference internal" href="../api/generated/deeptime.decomposition.TICA.html#deeptime.decomposition.TICA.fetch_model"><span class="std std-ref">fetch_model()</span></a> in order to transform / project data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">model</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">projection</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(500, 5)
</pre></div></div>
</div>
<p>For more details, please see below examples as well as the <a class="reference internal" href="../api/generated/deeptime.decomposition.TICA.html#deeptime.decomposition.TICA"><span class="std std-ref">API docs</span></a>.</p>
<section id="Comparison-vs. PCA">
<h2>Comparison vs. PCA<a class="headerlink" href="#Comparison-vs. PCA" title="Permalink to this headline">¶</a></h2>
<p>To highlight the advantages TICA can possess over Principle Component Analysis (PCA), we consider the following example setup:</p>
<p>We generate a synthetic trajectory of observations of states <span class="math">\(S = \{0, 1\}\)</span> which is generated from a Markov state model (see <a class="reference internal" href="../index_msm.html"><span class="doc">here</span></a> for documentation on Markov state models). The only important thing for now is that it contains conditional probability to go from one state to another, i.e., given a transition matrix</p>
<div class="math">
\[P = \begin{pmatrix} 0.97 & 0.03 \\ 0.03 & 0.97 \end{pmatrix}\]</div>
<p>we have a probability <span class="math">\(P_{11} = 97\%\)</span> to stay in state “0” and a <span class="math">\(P_{12} = 3\%\)</span> to transition from state “0” to state “1” and vice versa.</p>
<p>We map the state sequence into ellipsoidal shapes in 2-dimensional space. For more details, please see the example data’s <a class="reference internal" href="../api/generated/deeptime.data.ellipsoids.html#deeptime.data.ellipsoids"><span class="std std-ref">documentation</span></a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">deeptime.data</span> <span class="kn">import</span> <span class="n">ellipsoids</span>

<span class="c1"># create dataset instance</span>
<span class="n">ellipsoids</span> <span class="o">=</span> <span class="n">ellipsoids</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">17</span><span class="p">)</span>
<span class="c1"># discrete transitions</span>
<span class="n">discrete_trajectory</span> <span class="o">=</span> <span class="n">ellipsoids</span><span class="o">.</span><span class="n">discrete_trajectory</span><span class="p">(</span><span class="n">n_steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="c1"># corresponding observations</span>
<span class="n">feature_trajectory</span> <span class="o">=</span> <span class="n">ellipsoids</span><span class="o">.</span><span class="n">map_discrete_to_observations</span><span class="p">(</span><span class="n">discrete_trajectory</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Temporally, a relatively long time is spent in either of these distributions before jumping to the other.</p>
<p>This can be observed also in the two-dimensional right-hand plot: The data is supersampled (each consecutive point-pair in the time series is linearly interpolated with 50 interpolation points) so that transition jumps become visible; these transitions are significantly lower intensity than the ellipsoids. If jumps were frequent, the in-between region would be much brighter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># plotting</span>
<span class="n">f</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">constrained_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">flat</span>

<span class="c1"># discrete trajectory</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">discrete_trajectory</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Sequence of states from Markov state model&#39;</span><span class="p">);</span>

<span class="c1"># scatter plot of samples</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example data samples&#39;</span><span class="p">)</span>

<span class="c1"># interpolate ftraj so that 50 times more steps are made and transitions become visible</span>
<span class="c1"># in heatmap representation</span>
<span class="n">n_interp</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">n_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">discrete_trajectory</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">n_interp</span><span class="p">)</span>
<span class="n">ftraj_interp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n_steps</span><span class="o">*</span><span class="n">n_interp</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">ftraj_interp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">),</span> <span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">ftraj_interp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_steps</span><span class="p">),</span> <span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># heatmap</span>
<span class="n">hb</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">hexbin</span><span class="p">(</span><span class="n">ftraj_interp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ftraj_interp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">hb</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Supersampled example data in log-heatmap&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tica_16_0.png" src="../_images/notebooks_tica_16_0.png" />
</div>
</div>
<p>If we project back into one dimension with PCA, the result contains basically no signal: PCA finds the axis that maximizes variance, which is along long axis of the ellipsoids and completely ignores temporal information.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">)</span>  <span class="c1"># fit the 2-dimensional data</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">projection</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">projection</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;PCA projection of 2-dimensional trajectory&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="n">dxy</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">components_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># dominant pca component</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example data samples with dominant PCA component&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tica_18_0.png" src="../_images/notebooks_tica_18_0.png" />
</div>
</div>
<p>On the other hand, projecting with TICA takes temporal information into account and finds the dominant slow direction, i.e., the rare transition between the two distributions.</p>
<p>We create a TICA estimator, parameterized by the <code class="docutils literal notranslate"><span class="pre">lagtime</span></code>, which is the time shift <span class="math">\(\tau\)</span> for which autocorrelations are taken into account, and <code class="docutils literal notranslate"><span class="pre">dim</span></code>, which is the dimension. Here, the dimension can either be an <code class="docutils literal notranslate"><span class="pre">int</span></code> , a <code class="docutils literal notranslate"><span class="pre">float</span></code>, or <code class="docutils literal notranslate"><span class="pre">None</span></code> - each having significant influence on how the projection dimension is determined:</p>
<ul class="simple">
<li><p>in case <code class="docutils literal notranslate"><span class="pre">dim</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>, all available ranks are kept;</p></li>
<li><p>in case <code class="docutils literal notranslate"><span class="pre">dim</span></code> is an integer (like in this case), it must be positive and fixes the projection dimension to the given value;</p></li>
<li><p>in case <code class="docutils literal notranslate"><span class="pre">dim</span></code> is a floating point value (e.g., <code class="docutils literal notranslate"><span class="pre">TICA(...,</span> <span class="pre">dim=0.7)</span></code>), it must be <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">dim</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code>. Then, it selects the number of dimensions such that the amount of kinetic variance that needs to be explained is greater than the percentage specified by dim.</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica</span> <span class="o">=</span> <span class="n">TICA</span><span class="p">(</span>
    <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># fix projection dimension explicitly</span>
    <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now the <a class="reference internal" href="../api/generated/deeptime.decomposition.CovarianceKoopmanModel.html#deeptime.decomposition.CovarianceKoopmanModel"><span class="std std-ref">tica model</span></a> can be estimated.</p>
<p><em>Note</em>: In the reversible (default) case, this assumes that the data comes from an equilibirum distribution. Applying the method as-is to short off-equilibrium data produces heavily biased estimates. See <a class="reference external" href="#Koopman-reweighting">Koopman reweighting</a> (or the corresponding <a class="reference internal" href="../api/generated/deeptime.covariance.KoopmanWeightingEstimator.html#deeptime.covariance.KoopmanWeightingEstimator"><span class="std std-ref">API docs</span></a>) for a reweighting technique that extends TICA to non-equilibrium data.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica_model</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">,</span> <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>  <span class="c1"># fit and fetch model</span>
</pre></div>
</div>
</div>
<p>We repeat the visualization of above and plot the projected data as well as the dominant slow direction, maximizing autocorrelation (instead of variance, cf PCA).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tica_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TICA projection of 2-dimensional trajectory&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="n">dxy</span> <span class="o">=</span> <span class="n">tica_model</span><span class="o">.</span><span class="n">singular_vectors_left</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># dominant tica component</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example data samples with dominant TICA component&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tica_24_0.png" src="../_images/notebooks_tica_24_0.png" />
</div>
</div>
<p>The implied timescales of the tica model can be accessed as follows:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica_model</span><span class="o">.</span><span class="n">timescales</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([12.61266834,  0.28280506])
</pre></div></div>
</div>
<p>In principle, one should expect as many timescales as input coordinates were available. However, fewer eigenvalues will be returned if the TICA matrices were not full rank or <code class="docutils literal notranslate"><span class="pre">dim</span></code> contained a floating point percentage, i.e., was interpreted as variance cutoff.</p>
<p>The model also offers a function that yields an instantaneous correlation matrix between mean-free input features and TICs (i.e., the axes that are projected onto).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica_model</span><span class="o">.</span><span class="n">feature_component_correlation</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-0.01713845],
       [ 0.65760997]])
</pre></div></div>
</div>
<p>In greater detail: Denoting the input features as <span class="math">\(X_i\)</span> and the TICs as <span class="math">\(\theta_j\)</span>, the instantaneous, linear correlation between them can be written as</p>
<div class="math">
\[\mathbf{Corr}(X_i - \mu_i, \mathbf{\theta}_j) = \frac{1}{\sigma_{X_i - \mu_i}}\sum_l \sigma_{(X_i - \mu_i)(X_l - \mu_l)} \mathbf{U}_{li}.

\]</div>
<p>The matrix <span class="math">\(\mathbf{U}\)</span> is the matrix containing the eigenvectors of the TICA generalized eigenvalue problem as column vectors, i.e., there is a row for each feature and a column for each TIC.</p>
</section>
<section id="Eigenvector-scaling">
<h2>Eigenvector scaling<a class="headerlink" href="#Eigenvector-scaling" title="Permalink to this headline">¶</a></h2>
<p>The TICA estimator possesses a scaling parameter which can be used to introduce further properties to the projection. It can take the following values:</p>
<p><code class="docutils literal notranslate"><span class="pre">None</span></code>: No scaling.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica</span><span class="o">.</span><span class="n">scaling</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">tica_model</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">,</span> <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;kinetic_map&quot;</span></code> (default): Eigenvectors will be scaled by eigenvalues. As a result, Euclidean distances in the transformed data approximate kinetic distances <a class="footnote-reference brackets" href="#footcite-noe2015kinetic" id="id11">9</a>. This is a good choice when the data is further processed by clustering.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica</span><span class="o">.</span><span class="n">scaling</span> <span class="o">=</span> <span class="s2">&quot;kinetic_map&quot;</span>  <span class="c1"># default</span>
<span class="n">tica_model_kinetic_map</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">,</span> <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">&quot;commute_map&quot;</span></code>: Eigenvector i will be scaled by <span class="math">\(\sqrt{\mathrm{timescale}_i / 2}\)</span>. As a result, Euclidean distances in the transformed data will approximate commute distances <a class="footnote-reference brackets" href="#footcite-noe2016commute" id="id12">10</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica</span><span class="o">.</span><span class="n">scaling</span> <span class="o">=</span> <span class="s2">&quot;commute_map&quot;</span>
<span class="n">tica_model_commute_map</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">,</span> <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Visualizing the projections:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tica_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Unscaled&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tica_model_kinetic_map</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Kinetic map&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tica_model_commute_map</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Commute map&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TICA projection of 2-dimensional trajectory with different eigenvector scalings&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tica_39_0.png" src="../_images/notebooks_tica_39_0.png" />
</div>
</div>
</section>
<section id="Koopman-reweighting">
<h2>Koopman reweighting<a class="headerlink" href="#Koopman-reweighting" title="Permalink to this headline">¶</a></h2>
<p>If the data that is used for estimation (for the most part) is not in equilibrium, the estimate can become heavily biased in case reversibility is enforced. Koopman reweighting <a class="footnote-reference brackets" href="#footcite-wu2017variational" id="id13">7</a> assigns weights to each frame of the time series so that also off-equilibrium data can be used. In deeptime, a <a class="reference internal" href="../api/generated/deeptime.covariance.KoopmanWeightingEstimator.html#deeptime.covariance.KoopmanWeightingEstimator"><span class="std std-ref">Koopman weighting estimator</span></a> is implemented, which learns
appropriate weights from data. The corresponding <a class="reference internal" href="../api/generated/deeptime.covariance.KoopmanWeightingModel.html#deeptime.covariance.KoopmanWeightingModel"><span class="std std-ref">Koopman model</span></a> can be used as an argument in TICA’s <code class="docutils literal notranslate"><span class="pre">fit</span></code>.</p>
<p>This reweighting technique becomes necessary as soon as the available data is not a single long trajectory which equilibrates and then is in an equilibrium state for the rest of the time but rather if many short and at least initially off-equilibrium trajectories are used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica</span> <span class="o">=</span> <span class="n">TICA</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Learning the weights</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">deeptime.covariance</span> <span class="kn">import</span> <span class="n">KoopmanWeightingEstimator</span>

<span class="n">koopman_estimator</span> <span class="o">=</span> <span class="n">KoopmanWeightingEstimator</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">reweighting_model</span> <span class="o">=</span> <span class="n">koopman_estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>…and fitting TICA using said weights.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tica_model_reweighted</span> <span class="o">=</span> <span class="n">tica</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">reweighting_model</span><span class="p">)</span> \
    <span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Again the results can be visualized.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tica_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;TICA projection of 2-dimensional trajectory&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>

<span class="n">dxy</span> <span class="o">=</span> <span class="n">tica_model</span><span class="o">.</span><span class="n">singular_vectors_left</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># dominant tica component</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="o">.</span><span class="n">T</span><span class="p">),</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span> <span class="mi">4</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">feature_trajectory</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dxy</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Example data samples with dominant TICA component&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_tica_47_0.png" src="../_images/notebooks_tica_47_0.png" />
</div>
</div>
<p class="rubric">References</p>
<p id="id14"><dl class="footnote brackets">
<dt class="label" id="footcite-molgedey1994separation"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Lutz Molgedey and Heinz Georg Schuster. Separation of a mixture of independent signals using time delayed correlations. <em>Physical Review Letters</em>, 72(23):3634, 1994.</p>
</dd>
<dt class="label" id="footcite-naritomi2011slow"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Yusuke Naritomi and Sotaro Fuchigami. Slow dynamics in protein fluctuations revealed by time-structure based independent component analysis: the case of domain motions. <em>The Journal of chemical physics</em>, 134(6):02B617, 2011.</p>
</dd>
<dt class="label" id="footcite-perez2013identification"><span class="brackets">3</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id4">2</a>,<a href="#id8">3</a>)</span></dt>
<dd><p>Guillermo Pérez-Hernández, Fabian Paul, Toni Giorgino, Gianni De Fabritiis, and Frank Noé. Identification of slow molecular order parameters for markov model construction. <em>The Journal of chemical physics</em>, 139(1):07B604_1, 2013.</p>
</dd>
<dt class="label" id="footcite-schwantes2013improvements"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Christian R Schwantes and Vijay S Pande. Improvements in Markov state model construction reveal many non-native interactions in the folding of NTL9. <em>Journal of chemical theory and computation</em>, 9(4):2000–2009, 2013.</p>
</dd>
<dt class="label" id="footcite-williams2015data"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Matthew O Williams, Ioannis G Kevrekidis, and Clarence W Rowley. A data-driven approximation of the Koopman operator: extending dynamic mode decomposition. <em>Journal of Nonlinear Science</em>, 25(6):1307–1346, 2015.</p>
</dd>
<dt class="label" id="footcite-schmid2010dynamic"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><p>Peter J Schmid. Dynamic mode decomposition of numerical and experimental data. <em>Journal of fluid mechanics</em>, 656:5–28, 2010.</p>
</dd>
<dt class="label" id="footcite-wu2017variational"><span class="brackets">7</span><span class="fn-backref">(<a href="#id9">1</a>,<a href="#id13">2</a>)</span></dt>
<dd><p>Hao Wu, Feliks Nüske, Fabian Paul, Stefan Klus, Péter Koltai, and Frank Noé. Variational koopman models: slow collective variables and molecular kinetics from short off-equilibrium simulations. <em>The Journal of chemical physics</em>, 146(15):154104, 2017.</p>
</dd>
<dt class="label" id="footcite-landau2013quantum"><span class="brackets"><a class="fn-backref" href="#id10">8</a></span></dt>
<dd><p>Lev Davidovich Landau and Evgenii Mikhailovich Lifshitz. <em>Quantum mechanics: non-relativistic theory</em>. Volume 3. Elsevier, 2013.</p>
</dd>
<dt class="label" id="footcite-noe2015kinetic"><span class="brackets"><a class="fn-backref" href="#id11">9</a></span></dt>
<dd><p>Frank Noé and Cecilia Clementi. Kinetic distance and kinetic maps from molecular dynamics simulation. <em>Journal of chemical theory and computation</em>, 11(10):5002–5011, 2015.</p>
</dd>
<dt class="label" id="footcite-noe2016commute"><span class="brackets"><a class="fn-backref" href="#id12">10</a></span></dt>
<dd><p>Frank Noé, Ralf Banisch, and Cecilia Clementi. Commute maps: separating slowly mixing molecular configurations for kinetic modeling. <em>Journal of chemical theory and computation</em>, 12(11):5620–5630, 2016.</p>
</dd>
</dl>
</p>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../_static/scrollbar.js"></script>

  </body>
</html>