
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>class PBFSimulator &#8212; deeptime 0.4.2+4.g6433bb7e documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../../_static/d3.v5.min.js"></script>
    <script src="../../../_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="../../../_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="class DrunkardsWalk" href="deeptime.data.DrunkardsWalk.html" />
    <link rel="prev" title="class Ellipsoids" href="deeptime.data.Ellipsoids.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../../../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../_static/favicon-16x16.png">
<link rel="manifest" href="../../../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../../index.html">
    <img class="logo" src="../../../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_markov.html">deeptime.markov</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index_data.html">deeptime.data</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index_data.html#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index_data.html#custom-systems">Custom systems</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index_data.html#implementations">Implementations</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.DoubleWellDiscrete.html"><em>class</em> DoubleWellDiscrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.Ellipsoids.html"><em>class</em> Ellipsoids</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><em>class</em> PBFSimulator</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.DrunkardsWalk.html"><em>class</em> DrunkardsWalk</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.BickleyJet.html"><em>class</em> BickleyJet</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.BirthDeathChain.html"><em>class</em> BirthDeathChain</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.TimeDependentSystem.html"><em>class</em> TimeDependentSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.TimeIndependentSystem.html"><em>class</em> TimeIndependentSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.data.CustomSystem.html"><em>class</em> CustomSystem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../index_plots.html">deeptime.plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../../../index.html">Latest release
            (0.4.2)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../../../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../../contents.html">Documentation overview</a><ul>
  <li><a href="../../index_data.html">deeptime.data</a><ul>
      <li>Previous: <a href="deeptime.data.Ellipsoids.html" title="previous chapter"><em>class</em> Ellipsoids</a></li>
      <li>Next: <a href="deeptime.data.DrunkardsWalk.html" title="next chapter"><em>class</em> DrunkardsWalk</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../../../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="class-pbfsimulator">
<h1><em>class</em> PBFSimulator<a class="headerlink" href="#class-pbfsimulator" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeptime.data.</span></span><span class="sig-name descname"><span class="pre">PBFSimulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">domain_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_solver_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gravity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.016</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rest_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensile_instability_distance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tensile_instability_k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.data.PBFSimulator" title="Permalink to this definition">¶</a></dt>
<dd><p>A position based fluids simulator for two-dimensional systems. <a class="footnote-reference brackets" href="#footcite-macklin2013position" id="id1">1</a></p>
<p>Its underlying principle is by definition of a rest density <span class="math">\(\rho_0\)</span>, which the particles in the system
try to reach by a smoothed particle hydrodynamics style simulation <a class="footnote-reference brackets" href="#footcite-gingold1977smoothed" id="id2">2</a>
<a class="footnote-reference brackets" href="#footcite-lucy1977numerical" id="id3">3</a>. Up to numerics the simulation is deterministic given a set of parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>domain_size</strong> (<em>(</em><em>2</em><em>,</em><em>) </em><em>ndarray</em>) – A 1-dimensional ndarray with two elements describing the extension of the simulation box.</p></li>
<li><p><strong>initial_positions</strong> (<em>(</em><em>N</em><em>, </em><em>2</em><em>) </em><em>ndarray</em>) – A 2-dimensional ndarray describing the <span class="math">\(N\)</span> particles’ initial positions. This also fixes the number
of particles. It is preserved during runs of the simulation.</p></li>
<li><p><strong>interaction_distance</strong> (<em>float</em>) – Interaction distance for particles, influences the cell size for the neighbor list.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Number threads to use for simulation.</p></li>
<li><p><strong>n_solver_iterations</strong> (<em>int</em><em>, </em><em>default=5</em>) – The number of solver iterations for particle position updates. The more, the slower the simulation but also
the more accurate.</p></li>
<li><p><strong>gravity</strong> (<em>float</em><em>, </em><em>default=10</em>) – Gravity parameter which acts on particles’ velocities in each time step as constant force.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em><em>, </em><em>default=10</em>) – Damping parameter. The higher, the more damping.</p></li>
<li><p><strong>timestep</strong> (<em>float</em><em>, </em><em>default=0.016</em>) – The timestep used for propagation.</p></li>
<li><p><strong>rest_density</strong> (<em>float</em><em>, </em><em>defaul=1.</em>) – The rest density <span class="math">\(\rho_0\)</span>.</p></li>
<li><p><strong>tensile_instability_distance</strong> (<em>float</em><em>, </em><em>default=0.2</em>) – Parameter responsible for surface-tension-like effects.</p></li>
<li><p><strong>tensile_instability_k</strong> (<em>float</em><em>, </em><em>default=0.1</em>) – Also controls surface-tension effects.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Each particle has positions <span class="math">\(p_1,\ldots,p_n \in\mathbb{R}^d\)</span> and
velocity <span class="math">\(v_1,\ldots,v_n\in\mathbb{R^d}\)</span>. For the local density a standard SPH estimator is used</p>
<div class="math">
\[\rho_i = \sum_i m_i W(p_i - p_j, h),

\]</div>
<p>where <span class="math">\(m_i\)</span> refers to the particle’s mass (here <span class="math">\(m_i \equiv 1\)</span> for simplicity), <span class="math">\(W\)</span> is a
convolution kernel with interaction distance <span class="math">\(h\)</span>, i.e., particles with distance larger than <span class="math">\(h\)</span>
get assigned a weight of zero in the convolution operation.</p>
<p>The whole system has an underlying family of density constraints</p>
<div class="math">
\[C_i(p_1,\ldots,p_n) = \frac{\rho_i}{\rho_0} - 1.

\]</div>
<p>The simulation algorithm tries to fulfill this constraint by updating each particle’s position, i.e., it tries to
find <span class="math">\(\Delta p_k\)</span> so that</p>
<div class="math">
\[C_k(p_1,\ldots,p_k + \Delta p_k,\ldots,p_n) = 0.

\]</div>
<p>This is done by performing Newton’s optimization method along the constraint’s gradient. Because of potentially
vanishing gradients, the optimization is regularized / dampened with a parameter <span class="math">\(\varepsilon\)</span>. In this
implementation, larger values of <span class="math">\(\varepsilon\)</span> lead to more regularization.</p>
<p>When a particle has only very few neighbors, it might not be possible to reach the rest density. This can lead
to particle clumping (i.e., areas of negative pressures). One remedy is an artificial internal pressure term,
here referred to as tensile instability. It modifies the weighting inside the convolution kernel itself.
The default parameters <cite>tensile_instability_distance</cite> and <cite>tensile_instability_k</cite> are the suggested ones in the
PBF publication.</p>
<p class="rubric">References</p>
<div class="docutils container" id="id4">
<dl class="footnote brackets">
<dt class="label" id="footcite-macklin2013position"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Miles Macklin and Matthias Müller. Position based fluids. <em>ACM Transactions on Graphics (TOG)</em>, 32(4):1–12, 2013.</p>
</dd>
<dt class="label" id="footcite-gingold1977smoothed"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Robert A Gingold and Joseph J Monaghan. Smoothed particle hydrodynamics: theory and application to non-spherical stars. <em>Monthly notices of the royal astronomical society</em>, 181(3):375–389, 1977.</p>
</dd>
<dt class="label" id="footcite-lucy1977numerical"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Leon B Lucy. A numerical approach to the testing of the fission hypothesis. <em>The astronomical journal</em>, 82:1013–1024, 1977.</p>
</dd>
</dl>
</div>
<p class="rubric">Attributes</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.domain_size" title="deeptime.data.PBFSimulator.domain_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">domain_size</span></code></a></p></td>
<td><p>The size of the domain.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.n_particles" title="deeptime.data.PBFSimulator.n_particles"><code class="xref py py-obj docutils literal notranslate"><span class="pre">n_particles</span></code></a></p></td>
<td><p>Number of particles in the simulation.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.make_animation" title="deeptime.data.PBFSimulator.make_animation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_animation</span></code></a>(trajectories[, stride, mode])</p></td>
<td><p>Creates a matplotlib animation object consisting of either scatter plots of contour plots for plotting particles and densities, respectively.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.run" title="deeptime.data.PBFSimulator.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>(n_steps[, drift])</p></td>
<td><p>Performs <cite>n_steps</cite> many simulation steps and returns a trajectory of recorded particle positions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.simulate_oscillatory_force" title="deeptime.data.PBFSimulator.simulate_oscillatory_force"><code class="xref py py-obj docutils literal notranslate"><span class="pre">simulate_oscillatory_force</span></code></a>(n_oscillations, ...)</p></td>
<td><p>Runs <cite>2*n_oscillations*n_steps</cite> many simulation steps in total by applying the drift alternatingly in positive and  negative direction for <cite>n_steps</cite> each, <cite>n_oscillation</cite> times.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.data.PBFSimulator.transform_to_density" title="deeptime.data.PBFSimulator.transform_to_density"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transform_to_density</span></code></a>(trajectory[, n_grid_x, ...])</p></td>
<td><p>Transforms a two-dimensional PBF particle trajectory to a trajectory of densities by performing KDEs.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.make_animation">
<span class="sig-name descname"><span class="pre">make_animation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectories</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stride</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'scatter'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.data.PBFSimulator.make_animation" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a matplotlib animation object consisting of either scatter plots of contour plots for plotting
particles and densities, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectories</strong> (<em>list of ndarray</em>) – Input trajectories. Must all have same shape.</p></li>
<li><p><strong>stride</strong> (<em>int</em><em>, </em><em>default=1</em>) – Apply stride to frames so that fewer data is presented.</p></li>
<li><p><strong>mode</strong> (<em>str</em><em>, </em><em>default=&quot;scatter&quot;</em>) – Aside from “scatter” this also supports “contourf” for densities.</p></li>
<li><p><strong>**kw</strong> – <p>Optional keyword arguments. The following are supported:</p>
<ul>
<li><p>”n_grid_x”, required when in mode “contourf” (see <a class="reference internal" href="#deeptime.data.PBFSimulator.transform_to_density" title="deeptime.data.PBFSimulator.transform_to_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform_to_density()</span></code></a>)</p></li>
<li><p>”n_grid_y”, required when in mode “contourf” (see <a class="reference internal" href="#deeptime.data.PBFSimulator.transform_to_density" title="deeptime.data.PBFSimulator.transform_to_density"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform_to_density()</span></code></a>)</p></li>
<li><p>”figsize” controls figure size, defaults to (n_traj * 8, 6)</p></li>
<li><p>”ncols” controls number of columns, defaults to n_traj</p></li>
<li><p>”nrows” controls number of rows, defaults to 1</p></li>
<li><p>”titles” optional list of strings for titles</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>animation</strong> – Matplotlib animation object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>FuncAnimation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.data.PBFSimulator.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs <cite>n_steps</cite> many simulation steps and returns a trajectory of recorded particle positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps to run.</p></li>
<li><p><strong>drift</strong> (<em>float</em><em>, </em><em>default=0</em>) – Drift that is added to particles’ velocity in <cite>x</cite> direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>trajectory</strong> – Output trajectory.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(n_steps, 2) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.simulate_oscillatory_force">
<span class="sig-name descname"><span class="pre">simulate_oscillatory_force</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_oscillations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.data.PBFSimulator.simulate_oscillatory_force" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs <cite>2*n_oscillations*n_steps</cite> many simulation steps in total by applying the drift alternatingly
in positive and  negative direction for <cite>n_steps</cite> each, <cite>n_oscillation</cite> times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_oscillations</strong> (<em>int</em>) – Number of oscillations.</p></li>
<li><p><strong>n_steps</strong> (<em>int</em>) – Number of steps per run with a certain drift setting. Is then run again with the negated drift.</p></li>
<li><p><strong>drift</strong> (<em>float</em>) – The magnitude of the drift force into x direction.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>trajectory</strong> – Output trajectory.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(T, n) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.transform_to_density">
<span class="sig-name descname"><span class="pre">transform_to_density</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trajectory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_grid_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_grid_y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.data.PBFSimulator.transform_to_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms a two-dimensional PBF particle trajectory to a trajectory of densities by performing KDEs.
Since we have the prior knowledge that no particles get lost on the way, the densities are
normalized frame-wise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trajectory</strong> (<em>(</em><em>T</em><em>, </em><em>n</em><em>, </em><em>2</em><em>) </em><em>ndarray</em>) – The input trajectory for n particles.</p></li>
<li><p><strong>n_grid_x</strong> (<em>int</em><em>, </em><em>default=20</em>) – Number of evaluation points of simulation box in x direction.</p></li>
<li><p><strong>n_grid_y</strong> (<em>int</em><em>, </em><em>default=10</em>) – Number of evaluation points of simulation box in y direction.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Number of jobs to use when transforming to densities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>trajectory</strong> – Output trajectory</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(T, n_grid_x * n_grid_y) ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.domain_size">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">domain_size</span></span><a class="headerlink" href="#deeptime.data.PBFSimulator.domain_size" title="Permalink to this definition">¶</a></dt>
<dd><p>The size of the domain.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.data.PBFSimulator.n_particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_particles</span></span><a class="headerlink" href="#deeptime.data.PBFSimulator.n_particles" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of particles in the simulation.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../../../_static/scrollbar.js"></script>

  </body>
</html>