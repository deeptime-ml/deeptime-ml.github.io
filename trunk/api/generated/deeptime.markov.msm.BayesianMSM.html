
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>class BayesianMSM &#8212; deeptime 0.3.1+23.ga9f1138.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/d3.v5.min.js"></script>
    <script src="../../_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="../../_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="class TRAM" href="deeptime.markov.msm.TRAM.html" />
    <link rel="prev" title="class MaximumLikelihoodMSM" href="deeptime.markov.msm.MaximumLikelihoodMSM.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon-16x16.png">
<link rel="manifest" href="../../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index_markov.html">deeptime.markov</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index_markov.html#estimators">Estimators</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.msm.MaximumLikelihoodMSM.html"><em>class</em> MaximumLikelihoodMSM</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><em>class</em> BayesianMSM</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.msm.TRAM.html"><em>class</em> TRAM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#analysis-tools">Analysis tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#utilities-and-alternatives">Utilities and alternatives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../../index.html">Latest release
            (0.3.1)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index_markov.html">deeptime.markov</a><ul>
      <li>Previous: <a href="deeptime.markov.msm.MaximumLikelihoodMSM.html" title="previous chapter"><em>class</em> MaximumLikelihoodMSM</a></li>
      <li>Next: <a href="deeptime.markov.msm.TRAM.html" title="next chapter"><em>class</em> TRAM</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="class-bayesianmsm">
<h1><em>class</em> BayesianMSM<a class="headerlink" href="#class-bayesianmsm" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeptime.markov.msm.</span></span><span class="sig-name descname"><span class="pre">BayesianMSM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reversible</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stationary_distribution_constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sparse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.954</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxerr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bayesian estimator for MSMs given discrete trajectory statistics.</p>
<p>Implementation following <a class="footnote-reference brackets" href="#footcite-trendelkamp2015estimation" id="id1">1</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=100</em>) – Number of sampled transition matrices used in estimation of confidences.</p></li>
<li><p><strong>n_steps</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Number of Gibbs sampling steps for each transition matrix. If None, nsteps will be determined
automatically as the square root of the number of states in the full state space of the count matrix.
This is a heuristic for the number of steps it takes to decorrelate between samples.</p></li>
<li><p><strong>reversible</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=True</em>) – If true compute reversible MSM, else non-reversible MSM.</p></li>
<li><p><strong>stationary_distribution_constraint</strong> (<em>ndarray</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Stationary vector on the full set of states. Assign zero stationary probabilities to states for which the
stationary vector is unknown. Estimation will be made such that the resulting ensemble of transition
matrices is defined on the intersection of the states with positive stationary vector and the largest
connected set (undirected in the default case).</p></li>
<li><p><strong>sparse</strong> (<em>bool</em><em>, </em><em>optional</em><em>, </em><em>default=False</em>) – If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra. In
this case python sparse matrices will be returned by the corresponding functions instead of numpy arrays.
This behavior is suggested for very large numbers of states (e.g. &gt; 4000) because it is likely to be much
more efficient.</p></li>
<li><p><strong>confidence</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.954</em>) – Confidence interval. By default two sigma (95.4%) is used. Use 68.3% for one sigma, 99.7% for three sigma.</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=1000000</em>) – Optional parameter with reversible = True, sets the maximum number of iterations before the transition
matrix estimation method exits.</p></li>
<li><p><strong>maxerr</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default = 1e-8</em>) – Optional parameter with reversible = True. Convergence tolerance for transition matrix estimation. This
specifies the maximum change of the Euclidean norm of relative stationary probabilities
(<span class="math">\(x_i = \sum_k x_{ik}\)</span>). The relative stationary probability changes
<span class="math">\(e_i = (x_i^{(1)} - x_i^{(2)})/(x_i^{(1)} + x_i^{(2)})\)</span> are used in order to track changes in small
probabilities. The Euclidean norm of the change vector, <span class="math">\(|e_i|_2\)</span>, is compared to maxerr.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p id="id2"><dl class="footnote brackets">
<dt class="label" id="footcite-trendelkamp2015estimation"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Benjamin Trendelkamp-Schroer, Hao Wu, Fabian Paul, and Frank Noé. Estimation and uncertainty of reversible markov models. <em>The Journal of chemical physics</em>, 143(17):11B601_1, 2015.</p>
</dd>
</dl>
</p>
<p class="rubric">Examples</p>
<p>Note that the following example is only qualitatively and not
quantitatively reproducible because it involves random numbers.</p>
<p>We build a Bayesian Markov model for the following two trajectories at lag
time <span class="math">\(\tau=2\)</span>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">deeptime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtrajs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="n">deeptime</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">TransitionCountEstimator</span><span class="p">(</span><span class="n">lagtime</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">count_mode</span><span class="o">=</span><span class="s2">&quot;effective&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dtrajs</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mm</span> <span class="o">=</span> <span class="n">deeptime</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">BayesianMSM</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
</pre></div>
</div>
<p>The resulting Model contains a prior <a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MSM</span></code></a> as well as a list of sample
MSMs. Its transition matrix comes from a maximum likelihood estimation. We can access, e.g., the transition matrix
as follows:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">prior</span><span class="o">.</span><span class="n">transition_matrix</span><span class="p">)</span>  
<span class="go">[[ 0.70000001  0.16463699  0.135363  ]</span>
<span class="go"> [ 0.38169055  0.          0.61830945]</span>
<span class="go"> [ 0.12023989  0.23690297  0.64285714]]</span>
</pre></div>
</div>
<p>Furthermore the bayesian MSM posterior returned by <a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fetch_model" title="deeptime.markov.msm.BayesianMSM.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a> is able to
compute the probability distribution and statistical models of all methods
that are offered by the MSM object. This works as follows. The <a class="reference internal" href="deeptime.markov.msm.BayesianPosterior.html#deeptime.markov.msm.BayesianPosterior.gather_stats" title="deeptime.markov.msm.BayesianPosterior.gather_stats"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BayesianPosterior.gather_stats()</span></code></a> method
takes as argument the method you want to evaluate and then returns a statistics summary over requested quantity:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="s1">&#39;transition_matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>  
<span class="go">[[ 0.71108663  0.15947371  0.12943966]</span>
<span class="go"> [ 0.41076105  0.          0.58923895]</span>
<span class="go"> [ 0.13079372  0.23005443  0.63915185]]</span>
</pre></div>
</div>
<p>Likewise, the standard deviation by element:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="s1">&#39;transition_matrix&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">)</span>  
<span class="go">[[ 0.13707029  0.09479627  0.09200214]</span>
<span class="go"> [ 0.15247454  0.          0.15247454]</span>
<span class="go"> [ 0.07701315  0.09385258  0.1119089 ]]</span>
</pre></div>
</div>
<p>And this is the 95% (2 sigma) confidence interval. You can control the
percentile using the conf argument in this function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="s1">&#39;transition_matrix&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">L</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>  
<span class="go">[[ 0.44083423  0.03926518  0.0242113 ]</span>
<span class="go"> [ 0.14102544  0.          0.30729828]</span>
<span class="go"> [ 0.02440188  0.07629456  0.43682481]]</span>
<span class="go">[[ 0.93571706  0.37522581  0.40180041]</span>
<span class="go"> [ 0.69307665  0.          0.8649215 ]</span>
<span class="go"> [ 0.31029752  0.44035732  0.85994006]]</span>
</pre></div>
</div>
<p>If you want to compute expectations of functions that require arguments,
just pass these arguments as well:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mm</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="s1">&#39;mfpt&#39;</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span> 
<span class="go">12.9049811296</span>
</pre></div>
</div>
<p>And if you want to histogram the distribution or compute more complex
statistical moment such as the covariance between different quantities,
just get the full sample of your quantity of interest and evaluate it
at will:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">samples</span> <span class="o">=</span> <span class="n">mm</span><span class="o">.</span><span class="n">gather_stats</span><span class="p">(</span><span class="s1">&#39;mfpt&#39;</span><span class="p">,</span> <span class="n">store_samples</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">A</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">B</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">samples</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">samples</span><span class="p">[:</span><span class="mi">4</span><span class="p">])</span> 
<span class="go">[7.9763615793248155, 8.6540958274695701, 26.295326015231058, 17.909895469938899]</span>
</pre></div>
</div>
<p>Internally, the SampledMSM object has 100 transition matrices (the number
can be controlled by nsamples), that were computed by the transition matrix
sampling method. All of the above sample functions iterate over these 100
transition matrices and evaluate the requested function with the given
parameters on each of them.</p>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.has_model" title="deeptime.markov.msm.BayesianMSM.has_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_model</span></code></a></p></td>
<td><p>Property reporting whether this estimator contains an estimated model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.model" title="deeptime.markov.msm.BayesianMSM.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></p></td>
<td><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fetch_model" title="deeptime.markov.msm.BayesianMSM.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.reversible" title="deeptime.markov.msm.BayesianMSM.reversible"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reversible</span></code></a></p></td>
<td><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.sparse" title="deeptime.markov.msm.BayesianMSM.sparse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse</span></code></a></p></td>
<td><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.stationary_distribution_constraint" title="deeptime.markov.msm.BayesianMSM.stationary_distribution_constraint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stationary_distribution_constraint</span></code></a></p></td>
<td><p>The stationary distribution constraint that can either be None (no constraint) or constrains the count and transition matrices to states with positive stationary vector entries.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.chapman_kolmogorov_validator" title="deeptime.markov.msm.BayesianMSM.chapman_kolmogorov_validator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">chapman_kolmogorov_validator</span></code></a>(...[, test_model])</p></td>
<td><p>Returns a Chapman-Kolmogorov validator based on this estimator and a test model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fetch_model" title="deeptime.markov.msm.BayesianMSM.fetch_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_model</span></code></a>()</p></td>
<td><p>Yields the model that was estimated the most recent.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fit" title="deeptime.markov.msm.BayesianMSM.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(data[, callback])</p></td>
<td><p>Performs the estimation on either a count matrix or a previously estimated TransitionCountModel.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fit_fetch" title="deeptime.markov.msm.BayesianMSM.fit_fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_fetch</span></code></a>(data, **kwargs)</p></td>
<td><p>Fits the internal model on data and subsequently fetches it in one call.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fit_from_msm" title="deeptime.markov.msm.BayesianMSM.fit_from_msm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_from_msm</span></code></a>(msm[, callback])</p></td>
<td><p>Fits a bayesian posterior from a given Markov state model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.get_params" title="deeptime.markov.msm.BayesianMSM.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Get the parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.sample" title="deeptime.markov.msm.BayesianMSM.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a>(prior, n_samples[, n_steps, callback])</p></td>
<td><p>Performs sampling based on a prior.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.set_params" title="deeptime.markov.msm.BayesianMSM.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.chapman_kolmogorov_validator">
<span class="sig-name descname"><span class="pre">chapman_kolmogorov_validator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_metastable_sets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deeptime.markov.msm.BayesianPosterior.html#deeptime.markov.msm.BayesianPosterior" title="deeptime.markov._base.BayesianPosterior"><span class="pre">deeptime.markov._base.BayesianPosterior</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.chapman_kolmogorov_validator" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a Chapman-Kolmogorov validator based on this estimator and a test model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_metastable_sets</strong> (<em>int</em>) – Number of metastable sets to project the state space down to.</p></li>
<li><p><strong>mlags</strong> (<em>int</em><em> or </em><em>range</em><em> or </em><em>list</em>) – Multiple of lagtimes of the test_model to test against.</p></li>
<li><p><strong>test_model</strong> (<a class="reference internal" href="deeptime.markov.msm.BayesianPosterior.html#deeptime.markov.msm.BayesianPosterior" title="deeptime.markov.msm.BayesianPosterior"><em>BayesianPosterior</em></a><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – The model that is tested. If not provided, uses this estimator’s encapsulated model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>validator</strong> – The validator.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="deeptime.markov.MembershipsChapmanKolmogorovValidator.html#deeptime.markov.MembershipsChapmanKolmogorovValidator" title="deeptime.markov.MembershipsChapmanKolmogorovValidator">markov.MembershipsChapmanKolmogorovValidator</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.fetch_model">
<span class="sig-name descname"><span class="pre">fetch_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deeptime.markov.msm.BayesianPosterior.html#deeptime.markov.msm.BayesianPosterior" title="deeptime.markov._base.BayesianPosterior"><span class="pre">deeptime.markov._base.BayesianPosterior</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.fetch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the model that was estimated the most recent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>model</strong> – The estimated model or None if fit was not called.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="deeptime.markov.msm.BayesianPosterior.html#deeptime.markov.msm.BayesianPosterior" title="deeptime.markov.msm.BayesianPosterior">BayesianPosterior</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs the estimation on either a count matrix or a previously estimated TransitionCountModel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>(</em><em>N</em><em>,</em><em>N</em><em>) </em><em>count matrix</em><em> or </em><a class="reference internal" href="deeptime.markov.TransitionCountModel.html#deeptime.markov.TransitionCountModel" title="deeptime.markov.TransitionCountModel"><em>TransitionCountModel</em></a><em> or </em><a class="reference internal" href="deeptime.markov.msm.MaximumLikelihoodMSM.html#deeptime.markov.msm.MaximumLikelihoodMSM" title="deeptime.markov.msm.MaximumLikelihoodMSM"><em>MaximumLikelihoodMSM</em></a><em> or </em><a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><em>MarkovStateModel</em></a>) – a count matrix or a transition count model that was estimated from data</p></li>
<li><p><strong>callback</strong> (<em>callable</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Function to be called to indicate progress of sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Reference to self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM" title="deeptime.markov.msm.BayesianMSM">BayesianMSM</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.fit_fetch">
<span class="sig-name descname"><span class="pre">fit_fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.fit_fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the internal model on data and subsequently fetches it in one call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em>) – Data that is used to fit the model.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments to <a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fit" title="deeptime.markov.msm.BayesianMSM.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The estimated model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.fit_from_msm">
<span class="sig-name descname"><span class="pre">fit_from_msm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm._markov_state_model.MarkovStateModel"><span class="pre">deeptime.markov.msm._markov_state_model.MarkovStateModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.fit_from_msm" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits a bayesian posterior from a given Markov state model. The MSM must contain a count model to be able
to produce confidences. Note that the count model should be produced using effective counting, otherwise
counts are correlated and computed confidences are wrong.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msm</strong> (<a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><em>MarkovStateModel</em></a>) – The Markov state model to use as sampling start point.</p></li>
<li><p><strong>callback</strong> (<em>callable</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Function to be called to indicate progress of sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Reference to self.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#deeptime.markov.msm.BayesianMSM" title="deeptime.markov.msm.BayesianMSM">BayesianMSM</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>mapping of string to any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm._markov_state_model.MarkovStateModel"><span class="pre">deeptime.markov.msm._markov_state_model.MarkovStateModel</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs sampling based on a prior.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prior</strong> (<a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><em>MarkovStateModel</em></a>) – The MSM that is used as initial sampling point.</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) – The number of samples to draw.</p></li>
<li><p><strong>n_steps</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – The number of sampling steps for each transition matrix. If None, determined
by <span class="math">\(\sqrt{\mathrm{n\_states}}\)</span>.</p></li>
<li><p><strong>callback</strong> (<em>callable</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Callback function that indicates progress of sampling.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>samples</strong> – The generated samples</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <a class="reference internal" href="deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MarkovStateModel</span></code></a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>This method can in particular be used to append samples to an already estimated posterior:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">deeptime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtrajs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span>
<span class="gp">... </span>          <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">MaximumLikelihoodMSM</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">dtrajs</span><span class="p">,</span> <span class="n">lagtime</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">estimator</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">markov</span><span class="o">.</span><span class="n">msm</span><span class="o">.</span><span class="n">BayesianMSM</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posterior</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span><span class="o">.</span><span class="n">fetch_model</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">posterior</span><span class="o">.</span><span class="n">samples</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">estimator</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">prior</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">23</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">posterior</span><span class="o">.</span><span class="n">samples</span><span class="p">)</span> <span class="o">==</span> <span class="n">n_samples</span> <span class="o">+</span> <span class="mi">23</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**params</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.has_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.has_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Property reporting whether this estimator contains an estimated model. This assumes that the model
is initialized with <cite>None</cite> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.BayesianMSM.fetch_model" title="deeptime.markov.msm.BayesianMSM.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.reversible">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reversible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.reversible" title="Permalink to this definition">¶</a></dt>
<dd><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.sparse">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.
In this case python sparse matrices will be returned by the corresponding functions instead of numpy arrays.
This behavior is suggested for very large numbers of states (e.g. &gt; 4000) because it is likely
to be much more efficient.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.BayesianMSM.stationary_distribution_constraint">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stationary_distribution_constraint</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#deeptime.markov.msm.BayesianMSM.stationary_distribution_constraint" title="Permalink to this definition">¶</a></dt>
<dd><p>The stationary distribution constraint that can either be None (no constraint) or constrains the
count and transition matrices to states with positive stationary vector entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Getter</dt>
<dd class="field-odd"><p>Retrieves the currently configured constraint, can be None.</p>
</dd>
<dt class="field-even">Setter</dt>
<dd class="field-even"><p>Sets a stationary distribution constraint by giving a stationary vector as value. The estimated count-
and transition-matrices are restricted to states that have positive entries. In case the vector is
not normalized, setting it here implicitly copies and normalizes it.</p>
</dd>
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>ndarray or None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../../_static/scrollbar.js"></script>

  </body>
</html>