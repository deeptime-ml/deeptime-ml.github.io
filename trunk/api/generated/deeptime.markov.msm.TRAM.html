
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>class TRAM &#8212; deeptime 0.3.1+10.g65eecc5c.dirty documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="../../_static/d3.v5.min.js"></script>
    <script src="../../_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="../../_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="class MarkovStateModel" href="deeptime.markov.msm.MarkovStateModel.html" />
    <link rel="prev" title="class BayesianMSM" href="deeptime.markov.msm.BayesianMSM.html" />
<link rel="apple-touch-icon" sizes="180x180" href="../../_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../_static/favicon-16x16.png">
<link rel="manifest" href="../../_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_msm.html">Markov state models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index_markov.html">deeptime.markov</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index_markov.html#estimators">Estimators</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.msm.MaximumLikelihoodMSM.html"><em>class</em> MaximumLikelihoodMSM</a></li>
<li class="toctree-l3"><a class="reference internal" href="deeptime.markov.msm.BayesianMSM.html"><em>class</em> BayesianMSM</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#"><em>class</em> TRAM</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#models">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#analysis-tools">Analysis tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index_markov.html#utilities-and-alternatives">Utilities and alternatives</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/../../index.html">Latest release
            (0.3.1)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/../../index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../contents.html">Documentation overview</a><ul>
  <li><a href="../index_markov.html">deeptime.markov</a><ul>
      <li>Previous: <a href="deeptime.markov.msm.BayesianMSM.html" title="previous chapter"><em>class</em> BayesianMSM</a></li>
      <li>Next: <a href="deeptime.markov.msm.MarkovStateModel.html" title="next chapter"><em>class</em> MarkovStateModel</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="../../_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="class-tram">
<h1><em>class</em> TRAM<a class="headerlink" href="#class-tram" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deeptime.markov.msm.</span></span><span class="sig-name descname"><span class="pre">TRAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lagtime</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sliding'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'summed_counts_matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxerr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_convergence_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connectivity_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM" title="Permalink to this definition">¶</a></dt>
<dd><p>Transition(-based) Reweighting Analysis Method.
TRAM is described in <a class="footnote-reference brackets" href="#footcite-wu2016multiensemble" id="id1">1</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lagtime</strong> (<em>int</em>) – Integer lag time at which transitions are counted.</p></li>
<li><p><strong>count_mode</strong> (<em>str</em>) – <p>One of “sample”, “sliding”, “sliding-effective”, and “effective”.</p>
<ul>
<li><p>”sample” strides the trajectory with lagtime <span class="math">\(\tau\)</span> and uses the strided counts as transitions.</p></li>
<li><p>”sliding” uses a sliding window approach, yielding counts that are statistically correlated and too
large by a factor of <span class="math">\(\tau\)</span>; in uncertainty estimation this yields wrong uncertainties.</p></li>
<li><p>”sliding-effective” takes “sliding” and divides it by <span class="math">\(\tau\)</span>, which can be shown to provide a
likelihood that is the geometrical average over shifted subsamples of the trajectory,
<span class="math">\((s_1,\:s_{tau+1},\:...),\:(s_2,\:t_{tau+2},\:...),\)</span> etc. This geometrical average converges to
the correct likelihood in the statistical limit <a class="footnote-reference brackets" href="#footcite-trendelkamp2015estimation" id="id2">2</a>.</p></li>
<li><p>”effective” uses an estimate of the transition counts that are statistically uncorrelated.
Recommended when estimating Bayesian MSMs.</p></li>
</ul>
</p></li>
<li><p><strong>connectivity</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default='post_hoc_RE'</em>) – <p>One of ‘post_hoc_RE’, ‘BAR_variance’, or ‘summed_count_matrix’.
Defines what should be considered a connected set in the joint (product) space
of conformations and thermodynamic ensembles.</p>
<ul>
<li><p>’post_hoc_RE’ : It is required that every state in the connected set can be reached by following a
pathway of reversible transitions or jumping between overlapping thermodynamic states while staying in
the same Markov state. A reversible transition between two Markov states (within the same thermodynamic
state k) is a pair of Markov states that belong to the same strongly connected component of the count
matrix (from thermodynamic state k). Two thermodynamic states k and l are defined to overlap at Markov
state n if a replica exchange simulation <a class="footnote-reference brackets" href="#footcite-hukushima1996exchange" id="id3">3</a> restricted to state n would
show at least one transition from k to l or one transition from from l to k.
The expected number of replica exchanges is estimated from
the simulation data. The minimal number required of replica exchanges per Markov state can be increased by
decreasing <cite>connectivity_factor</cite>.</p></li>
<li><p>’BAR_variance’ : like ‘post_hoc_RE’ but with a different condition to define the thermodynamic overlap
based on the variance of the BAR estimator <a class="footnote-reference brackets" href="#footcite-shirts2008statistically" id="id4">4</a>.
Two thermodynamic states k and l are defined to overlap
at Markov state n if the variance of the free energy difference Delta <span class="math">\(f_{kl}\)</span> computed with BAR (and
restricted to conformations form Markov state n) is less or equal than one. The minimally required variance
can be controlled with <cite>connectivity_factor</cite>.</p></li>
<li><p>’summed_count_matrix’ : all thermodynamic states are assumed to overlap. The connected set is then
computed by summing the count matrices over all thermodynamic states and taking its largest strongly
connected set. Not recommended!</p></li>
</ul>
</p></li>
<li><p><strong>maxiter</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=10000</em>) – The maximum number of self-consistent iterations before the estimator exits unsuccessfully.</p></li>
<li><p><strong>maxerr</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1E-15</em>) – Convergence criterion based on the maximal free energy change in a self-consistent
iteration step.</p></li>
<li><p><strong>save_convergence_info</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Every saveConvergenceInfo iteration steps, store the actual increment and the actual log-likelihood; 0
means no storage.</p></li>
<li><p><strong>connectivity_factor</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=1.0</em>) – Only needed if connectivity=’post_hoc_RE’ or ‘BAR_variance’. Values greater than 1.0 weaken the connectivity
conditions. For ‘post_hoc_RE’ this multiplies the number of hypothetically observed transitions. For
‘BAR_variance’ this scales the threshold for the minimal allowed variance of free energy differences.</p></li>
<li><p><strong>progress_bar</strong> (<em>object</em>) – Progress bar object that TRAM will call to indicate progress to the user.
Tested for a tqdm progress bar. Should implement update() and close() and have .total and .desc properties.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p id="id5"><dl class="footnote brackets">
<dt class="label" id="footcite-wu2016multiensemble"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><p>Hao Wu, Fabian Paul, Christoph Wehmeyer, and Frank Noé. Multiensemble markov models of molecular thermodynamics and kinetics. <em>Proceedings of the National Academy of Sciences</em>, 113(23):E3221–E3230, 2016.</p>
</dd>
<dt class="label" id="footcite-trendelkamp2015estimation"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Benjamin Trendelkamp-Schroer, Hao Wu, Fabian Paul, and Frank Noé. Estimation and uncertainty of reversible markov models. <em>The Journal of chemical physics</em>, 143(17):11B601_1, 2015.</p>
</dd>
<dt class="label" id="footcite-hukushima1996exchange"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Koji Hukushima and Koji Nemoto. Exchange monte carlo method and application to spin glass simulations. <em>Journal of the Physical Society of Japan</em>, 65(6):1604–1608, 1996.</p>
</dd>
<dt class="label" id="footcite-shirts2008statistically"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Michael R Shirts and John D Chodera. Statistically optimal analysis of samples from multiple equilibrium states. <em>The Journal of chemical physics</em>, 129(12):124105, 2008.</p>
</dd>
</dl>
</p>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.connectivity_options" title="deeptime.markov.msm.TRAM.connectivity_options"><code class="xref py py-obj docutils literal notranslate"><span class="pre">connectivity_options</span></code></a></p></td>
<td><p>All possible connectivity modes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.has_model" title="deeptime.markov.msm.TRAM.has_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_model</span></code></a></p></td>
<td><p>Property reporting whether this estimator contains an estimated model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.log_likelihood" title="deeptime.markov.msm.TRAM.log_likelihood"><code class="xref py py-obj docutils literal notranslate"><span class="pre">log_likelihood</span></code></a></p></td>
<td><p>The parameter-dependent part of the TRAM likelihood.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.markov_state_energies" title="deeptime.markov.msm.TRAM.markov_state_energies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">markov_state_energies</span></code></a></p></td>
<td><p>The estimated free energy for each Markov state, summed over all thermodynamic states, <span class="math">\(f^i\)</span>, where <span class="math">\(i\)</span> is the Markov state index.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.model" title="deeptime.markov.msm.TRAM.model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">model</span></code></a></p></td>
<td><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.TRAM.fetch_model" title="deeptime.markov.msm.TRAM.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.reversible" title="deeptime.markov.msm.TRAM.reversible"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reversible</span></code></a></p></td>
<td><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.sparse" title="deeptime.markov.msm.TRAM.sparse"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sparse</span></code></a></p></td>
<td><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.therm_state_energies" title="deeptime.markov.msm.TRAM.therm_state_energies"><code class="xref py py-obj docutils literal notranslate"><span class="pre">therm_state_energies</span></code></a></p></td>
<td><p>The estimated free energy per thermodynamic state, <span class="math">\(f_k\)</span>, where <span class="math">\(k\)</span> is the thermodynamic state index.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.compute_sample_weights" title="deeptime.markov.msm.TRAM.compute_sample_weights"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_sample_weights</span></code></a>([therm_state])</p></td>
<td><p>Get the sample weight <span class="math">\(\mu(x)\)</span> for all samples <span class="math">\(x\)</span>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.fetch_model" title="deeptime.markov.msm.TRAM.fetch_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fetch_model</span></code></a>()</p></td>
<td><p>Yields the most recent <a class="reference internal" href="deeptime.markov.msm.MarkovStateModelCollection.html#deeptime.markov.msm.MarkovStateModelCollection" title="deeptime.markov.msm.MarkovStateModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarkovStateModelCollection</span></code></a> that was estimated.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.fit" title="deeptime.markov.msm.TRAM.fit"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit</span></code></a>(data, *args, **kw)</p></td>
<td><p>Fit a MarkovStateModelCollection to the given input data, using TRAM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.fit_fetch" title="deeptime.markov.msm.TRAM.fit_fetch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_fetch</span></code></a>(data, **kwargs)</p></td>
<td><p>Fits the internal model on data and subsequently fetches it in one call.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.get_params" title="deeptime.markov.msm.TRAM.get_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_params</span></code></a>([deep])</p></td>
<td><p>Get the parameters.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#deeptime.markov.msm.TRAM.set_params" title="deeptime.markov.msm.TRAM.set_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set_params</span></code></a>(**params)</p></td>
<td><p>Set the parameters of this estimator.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.compute_sample_weights">
<span class="sig-name descname"><span class="pre">compute_sample_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">therm_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM.compute_sample_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the sample weight <span class="math">\(\mu(x)\)</span> for all samples <span class="math">\(x\)</span>. If the thermodynamic state index is &gt;=0,
the sample weights for that thermodynamic state will be computed, i.e. <span class="math">\(\mu^k(x)\)</span>. Otherwise, this gives
the unbiased sample weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>therm_state</strong> (<em>int</em><em>, </em><em>optional</em>) – The index of the thermodynamic state in which the sample weights need to be computed. If therm_state=-1,
the unbiased sample weights are computed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sample_weights</strong> – The statistical weight <span class="math">\(\mu(x)\)</span> of each sample (i.e., the probability distribution over all samples:
the sum over all sample weights equals one.)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The statistical distribution is given by</p>
<div class="math">
\[\mu(x) = \left( \sum_k R^k_{i(x)} \mathrm{exp}[f^k_{i(k)}-b^k(x)] \right)^{-1}

\]</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.fetch_model">
<span class="sig-name descname"><span class="pre">fetch_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="deeptime.markov.msm.MarkovStateModelCollection.html#deeptime.markov.msm.MarkovStateModelCollection" title="deeptime.markov.msm._markov_state_model.MarkovStateModelCollection"><span class="pre">deeptime.markov.msm._markov_state_model.MarkovStateModelCollection</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#deeptime.markov.msm.TRAM.fetch_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Yields the most recent <a class="reference internal" href="deeptime.markov.msm.MarkovStateModelCollection.html#deeptime.markov.msm.MarkovStateModelCollection" title="deeptime.markov.msm.MarkovStateModelCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarkovStateModelCollection</span></code></a> that was estimated.
Can be None if fit was not called.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>model</strong> – The most recent markov state model or None.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="deeptime.markov.msm.MarkovStateModelCollection.html#deeptime.markov.msm.MarkovStateModelCollection" title="deeptime.markov.msm.MarkovStateModelCollection">MarkovStateModelCollection</a> or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kw</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a MarkovStateModelCollection to the given input data, using TRAM.
For each thermodynamic state, there is one Markov Model in the collection at the respective thermodynamic state
index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<em>tuple consisting of</em><em> (</em><em>dtrajs</em><em>, </em><em>bias_matrices</em><em>) or </em><em>(</em><em>dtrajs</em><em>, </em><em>bias_matrices</em><em>, </em><em>ttrajs</em><em>)</em><em></em>) – <ul class="simple">
<li><p>dtrajs: ndarray
The discrete trajectories in the form an 2-d integer ndarray. dtrajs[i] contains one trajectory.
dtrajs[i][n] contains the Markov state index that the n-th sample from the i-th trajectory was binned
into. Each of the dtrajs can be of variable length.</p></li>
<li><p>bias_matrices: ndarray
The bias energy matrices. bias_matrices[i, n, l] contains the bias energy of the n-th sample from the i-th
trajectory, evaluated at thermodynamic state k. The bias energy matrices should have the same size as
dtrajs in both the 0-th and 1-st dimension. The seconds dimension of of size n_therm_state, i.e. for each
sample, the bias energy in every thermodynamic state is calculated and stored in the bias_matrices.</p></li>
<li><p>ttrajs: ndarray, optional
ttrajs[i] indicates for each sample in the i-th trajectory what thermodynamic state that sample was
sampled at. If ttrajs is None, we assume no replica exchange was done. In this case we assume each
trajectory  corresponds to a unique thermodynamic state, and n_therm_states equals the size of dtrajs.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.fit_fetch">
<span class="sig-name descname"><span class="pre">fit_fetch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM.fit_fetch" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the internal model on data and subsequently fetches it in one call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array_like</em>) – Data that is used to fit the model.</p></li>
<li><p><strong>**kwargs</strong> – Additional arguments to <a class="reference internal" href="#deeptime.markov.msm.TRAM.fit" title="deeptime.markov.msm.TRAM.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The estimated model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM.get_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>params</strong> – Parameter names mapped to their values.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>mapping of string to any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.set_params">
<span class="sig-name descname"><span class="pre">set_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#deeptime.markov.msm.TRAM.set_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the parameters of this estimator.</p>
<p>The method works on simple estimators as well as on nested objects
(such as pipelines). The latter have parameters of the form
<code class="docutils literal notranslate"><span class="pre">&lt;component&gt;__&lt;parameter&gt;</span></code> so that it’s possible to update each
component of a nested object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**params</strong> (<em>dict</em>) – Estimator parameters.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>self</strong> – Estimator instance.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.connectivity_options">
<span class="sig-name descname"><span class="pre">connectivity_options</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['post_hoc_RE',</span> <span class="pre">'BAR_variance',</span> <span class="pre">'summed_count_matrix',</span> <span class="pre">None]</span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.connectivity_options" title="Permalink to this definition">¶</a></dt>
<dd><p>All possible connectivity modes</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.has_model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_model</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.has_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Property reporting whether this estimator contains an estimated model. This assumes that the model
is initialized with <cite>None</cite> otherwise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.log_likelihood">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_likelihood</span></span><a class="headerlink" href="#deeptime.markov.msm.TRAM.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>The parameter-dependent part of the TRAM likelihood.</p>
<p>The definition can be found in <a class="footnote-reference brackets" href="#footcite-wu2016multiensemble" id="id6">1</a>, Equation (9).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>log_likelihood</strong> – The parameter-dependent part of the log-likelihood.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Parameter-dependent, i.e., the factor</p>
<div class="math">
\[\prod_{x \in X} e^{-b^{k(x)}(x)}

\]</div>
<p>does not occur in the log-likelihood as it is constant with respect to the parameters, leading to</p>
<div class="math">
\[\log \prod_{k=1}^K \left(\prod_{i,j} (p_{ij}^k)^{c_{ij}^k}\right) \left(\prod_{i} \prod_{x \in X_i^k} \mu(x) e^{f_i^k} \right)

\]</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.markov_state_energies">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">markov_state_energies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.markov_state_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>The estimated free energy for each Markov state, summed over all thermodynamic states, <span class="math">\(f^i\)</span>, where
<span class="math">\(i\)</span> is the Markov state index.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#deeptime.markov.msm.TRAM.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Shortcut to <a class="reference internal" href="#deeptime.markov.msm.TRAM.fetch_model" title="deeptime.markov.msm.TRAM.fetch_model"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fetch_model()</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.reversible">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reversible</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.reversible" title="Permalink to this definition">¶</a></dt>
<dd><p>If true compute reversible MarkovStateModel, else non-reversible MarkovStateModel</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.sparse">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sparse</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.sparse" title="Permalink to this definition">¶</a></dt>
<dd><p>If true compute count matrix, transition matrix and all derived quantities using sparse matrix algebra.
In this case python sparse matrices will be returned by the corresponding functions instead of numpy arrays.
This behavior is suggested for very large numbers of states (e.g. &gt; 4000) because it is likely
to be much more efficient.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deeptime.markov.msm.TRAM.therm_state_energies">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">therm_state_energies</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#deeptime.markov.msm.TRAM.therm_state_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>The estimated free energy per thermodynamic state, <span class="math">\(f_k\)</span>, where <span class="math">\(k\)</span> is the thermodynamic state
index.</p>
</dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="../../_static/scrollbar.js"></script>

  </body>
</html>