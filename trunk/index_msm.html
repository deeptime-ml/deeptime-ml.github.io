
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Markov state models &#8212; deeptime 0.4.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/perfect-scrollbar/css/perfect-scrollbar.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="_static/perfect-scrollbar/js/perfect-scrollbar.min.js"></script>
    <script src="_static/d3.v5.min.js"></script>
    <script src="_static/d3-legend.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/contrib/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Transition counting" href="notebooks/transition-counting.html" />
    <link rel="prev" title="SINDy" href="notebooks/sindy.html" />
<link rel="apple-touch-icon" sizes="180x180" href="_static/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
<link rel="manifest" href="_static/site.webmanifest">

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo/deeptime_romand_white.svg" alt="Logo"/>
    
  </a>
</p>










<!-- h3>Navigation</h3 -->
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index_dimreduction.html">Dimension reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_deepdimreduction.html">Deep dim reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/sindy.html">SINDy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Markov state models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="notebooks/transition-counting.html">Transition counting</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/mlmsm.html">Maximum-likelihood MSMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/pcca.html">Coarse-graining with PCCA+</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/tpt.html">Transition path theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="notebooks/tram.html">TRAM</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/hmm.html">Hidden Markov Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/clustering.html">Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="datasets/index.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="index_dev.html">For developers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index_base.html">deeptime.base</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_clustering.html">deeptime.clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_sindy.html">deeptime.sindy</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_covariance.html">deeptime.covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_decomposition.html">deeptime.decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_markov.html">deeptime.markov</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_markov_hmm.html">deeptime.markov.hmm</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_markov_tools.html">deeptime.markov.tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_basis.html">deeptime.basis</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_kernels.html">deeptime.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_data.html">deeptime.data</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_plots.html">deeptime.plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_numeric.html">deeptime.numeric</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/index_util.html">deeptime.util</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="protocols.html">Release protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="imprint.html">Imprint</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Software License</a></li>
</ul>





<!--
<p>
    <iframe src="https://ghbtns.com/github-btn.html?user=deeptime-ml&repo=deeptime&type=star&count=true&size=large&v=2"
            allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>
--><p class="caption">
    <span class="caption-text">Version</span>
</p>
<ul>
    <li class="toctree-l1">
        <a class="reference internal" id="version-latest"
           href="../latest/index.html">Latest release
            (0.4.1)</a>
    </li>
    <li class="toctree-l1">
        <a class="reference internal" id="version-trunk"
           href="../trunk/index.html">Trunk version</a>
    </li>
</ul>
<script>
    if (window.location.href.indexOf("latest") > -1) {
        document.getElementById("version-latest").className = "reference internal current";
        document.getElementById("version-trunk").className = "reference internal";
    } else {
        document.getElementById("version-latest").className = "reference internal";
        document.getElementById("version-trunk").className = "reference internal current";
    }
</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="contents.html">Documentation overview</a><ul>
      <li>Previous: <a href="notebooks/sindy.html" title="previous chapter">SINDy</a></li>
      <li>Next: <a href="notebooks/transition-counting.html" title="next chapter">Transition counting</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" placeholder="Quick search" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="github-wrapper">
    <a href="https://github.com/deeptime-ml/deeptime"
       style="width: 16rem; height:100%; position:absolute; top:0; left:0;">
        <img class="side-logo logo-github" src="_static/GitHub-Mark-Light-32px.png" alt="gh"/>
        <div style="display: table; height: 100%; overflow: hidden;">
            <div style="display: table-cell; vertical-align: middle;">
                <div>deeptime &#64; GitHub
                </div>
            </div>
        </div>
    </a>
</div>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="markov-state-models">
<h1>Markov state models<a class="headerlink" href="#markov-state-models" title="Permalink to this headline">¶</a></h1>
<p>Here we introduce several types of markov state models as well as analysis tools related to them. At the very core,
markov state models are a stochastic model describing chains of events where the state of one particular point in time
only depends on the state prior to it, i.e., considering the chain of events <span class="math">\((\ldots,X_{t-2}, X_{t-1}, X_t)\)</span> with
a set of possible states <span class="math">\(S\)</span>, the probability of encountering a particular state <span class="math">\(X_{t+1}\in S\)</span> is a
conditional probability on <span class="math">\(X_t\in S\)</span>.</p>
<p>A great deal is written about MSMs in the literature, so we omit many crucial discussions here.
The 2018 review by Husic and Pande <a class="footnote-reference brackets" href="#footcite-husic2018markov" id="id1">1</a> is a good place to start for a high-level
discussion of Markov state models
and a chronology of their development in the context of molecular kinetics. Figure 3 is particularly helpful for
understanding the many “flavors” of MSM analyses developed.
A comprehensive overview of the mathematics was presented by Prinz et al <a class="footnote-reference brackets" href="#footcite-prinz2011markov" id="id2">2</a>,
including the MLE estimator used in Maximum Likelihood MSMs. This content is also covered
in Chapter 4 of a useful book on Markov state models <a class="footnote-reference brackets" href="#footcite-bowman2013introduction" id="id3">3</a>, which is a valuable
resource for many aspects of Markov state modeling (see book Figure 1.1).</p>
<p>The standard formulation - which is also employed here - assumes that <span class="math">\(S\)</span> is discrete and of finite cardinality.
This means that when related back to continuous-space processes, these discrete states represent a Voronoi tessellation
of state space and can be obtained via indicator functions.</p>
<p>These conditional probabilities are often described as so-called
<em>transition matrix</em> <span class="math">\(P\in \mathbb{R}^{n\times n}\)</span>, where <span class="math">\(n = |S|\)</span>, the number of states.
Assuming that <span class="math">\(S\)</span> is represented by the enumeration <span class="math">\(\{1,\ldots,n\}\)</span>, it is</p>
<div class="math">
\[P_{ij} = \mathbb{P}(X_{t+1}=j \mid X_t = i)\quad\forall t,

\]</div>
<p>i.e., the probability of transitioning to state <span class="math">\(i\)</span> given one is currently in state <span class="math">\(j\)</span>.
This also means that <span class="math">\(P\)</span> is a row-stochastic matrix</p>
<div class="math">
\[\sum_{j=1}^n P_{ij} = 1 \quad\forall i=1,\ldots,n.

\]</div>
<p>If a markov state model is available, interesting dynamical quantities can be computed, e.g., mean first passage times
and fluxes between (sets of) states <a class="footnote-reference brackets" href="#footcite-metzner2009transition" id="id4">4</a>, timescales, metastable decompositions
of markov states <a class="footnote-reference brackets" href="#footcite-roblitz2013fuzzy" id="id5">5</a>.</p>
<p>The goal of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">deeptime.markov</span></code> package is to provide tools to estimate and analyze markov state
models from discrete-state timeseries data. If the data’s domain is not discrete,
<a class="reference internal" href="notebooks/clustering.html"><span class="doc">clustering</span></a> can be employed to assign each frame to a state.</p>
<p>In the following, we introduce the core object, the <a class="reference internal" href="api/generated/deeptime.markov.msm.MarkovStateModel.html#deeptime.markov.msm.MarkovStateModel" title="deeptime.markov.msm.MarkovStateModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">MarkovStateModel</span></code></a>,
as well as a variety of estimators.</p>
<p>When estimating a MSM from time series data, it is important to collect statistics
over the encountered state transitions. This is covered in <a class="reference internal" href="notebooks/transition-counting.html"><span class="doc">transition counting</span></a>.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/transition-counting.html">Transition counting</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/mlmsm.html">Maximum-likelihood MSMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/pcca.html">Coarse-graining with PCCA+</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/tpt.html">Transition path theory</a></li>
</ul>
</div>
<p>Furthermore, deeptime implements <a class="reference internal" href="api/generated/deeptime.markov.msm.AugmentedMSMEstimator.html#deeptime.markov.msm.AugmentedMSMEstimator" title="deeptime.markov.msm.AugmentedMSMEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">Augmented</span> <span class="pre">Markov</span> <span class="pre">models</span></code></a>
<a class="footnote-reference brackets" href="#footcite-olsson2017combining" id="id6">6</a> which can be used when experimental data is available, as well as
<a class="reference internal" href="api/generated/deeptime.markov.msm.OOMReweightedMSM.html#deeptime.markov.msm.OOMReweightedMSM" title="deeptime.markov.msm.OOMReweightedMSM"><code class="xref py py-class docutils literal notranslate"><span class="pre">Observable</span> <span class="pre">Operator</span> <span class="pre">Model</span> <span class="pre">MSMs</span></code></a> <a class="footnote-reference brackets" href="#footcite-nuske2017markov" id="id7">7</a> which is
an unbiased estimator for the MSM transition matrix that corrects for the effect of starting out of equilibrium,
even when short lag times are used.</p>
<p class="rubric">Multiensemble MSMs</p>
<p>Deeptime offers the TRAM method <a class="footnote-reference brackets" href="#footcite-wu2016multiensemble" id="id8">8</a> for estimating multiensemble MSMs. These are collections
of MSMs based on simulations that are governed by biased dynamics (i.e., replica exchange simulations
and umbrella sampling).</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/tram.html">TRAM</a></li>
</ul>
</div>
<p class="rubric">References</p>
<p id="id9"><dl class="footnote brackets">
<dt class="label" id="footcite-husic2018markov"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Brooke E Husic and Vijay S Pande. Markov state models: from an art to a science. <em>Journal of the American Chemical Society</em>, 140(7):2386–2396, 2018.</p>
</dd>
<dt class="label" id="footcite-prinz2011markov"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Jan-Hendrik Prinz, Hao Wu, Marco Sarich, Bettina Keller, Martin Senne, Martin Held, John D Chodera, Christof Schütte, and Frank Noé. Markov models of molecular kinetics: generation and validation. <em>The Journal of chemical physics</em>, 134(17):174105, 2011.</p>
</dd>
<dt class="label" id="footcite-bowman2013introduction"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Gregory R Bowman, Vijay S Pande, and Frank Noé. <em>An introduction to Markov state models and their application to long timescale molecular simulation</em>. Volume 797. Springer Science &amp; Business Media, 2013.</p>
</dd>
<dt class="label" id="footcite-metzner2009transition"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Philipp Metzner, Christof Schütte, and Eric Vanden-Eijnden. Transition path theory for markov jump processes. <em>Multiscale Modeling &amp; Simulation</em>, 7(3):1192–1219, 2009.</p>
</dd>
<dt class="label" id="footcite-roblitz2013fuzzy"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>Susanna Röblitz and Marcus Weber. Fuzzy spectral clustering by pcca+: application to markov state models and data classification. <em>Advances in Data Analysis and Classification</em>, 7(2):147–179, 2013.</p>
</dd>
<dt class="label" id="footcite-olsson2017combining"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Simon Olsson, Hao Wu, Fabian Paul, Cecilia Clementi, and Frank Noé. Combining experimental and simulation data of molecular processes via augmented markov models. <em>Proceedings of the National Academy of Sciences</em>, 114(31):8265–8270, 2017.</p>
</dd>
<dt class="label" id="footcite-nuske2017markov"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p>Feliks Nüske, Hao Wu, Jan-Hendrik Prinz, Christoph Wehmeyer, Cecilia Clementi, and Frank Noé. Markov state models from short non-equilibrium simulations—analysis and correction of estimation bias. <em>The Journal of Chemical Physics</em>, 146(9):094104, 2017.</p>
</dd>
<dt class="label" id="footcite-wu2016multiensemble"><span class="brackets"><a class="fn-backref" href="#id8">8</a></span></dt>
<dd><p>Hao Wu, Fabian Paul, Christoph Wehmeyer, and Frank Noé. Multiensemble markov models of molecular thermodynamics and kinetics. <em>Proceedings of the National Academy of Sciences</em>, 113(23):E3221–E3230, 2016.</p>
</dd>
</dl>
</p>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
<script src="_static/scrollbar.js"></script>

  </body>
</html>